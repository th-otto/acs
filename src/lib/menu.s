		.text

call_click:
		movem.l    d3/a2-a4,-(a7)
		movea.l    a0,a4
		movea.l    a1,a2
		move.w     d0,d3
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		lea.l      0(a2,d1.l),a0
		moveq.l    #32,d2
		and.w      8(a0),d2
		bne.s      call_click_1
		moveq.l    #8,d1
		and.w      10(a0),d1
		bne.s      call_click_1
		lea.l      24(a0),a3
		move.w     8(a3),d0
		and.w      #$8000,d0
		beq.s      call_click_1
		move.l     (a3),d2
		beq.s      call_click_1
		lea.l      ACSblk,a0
		movea.l    (a0),a1
		move.l     a4,600(a1)
		movea.l    (a0),a1
		move.l     a2,604(a1)
		movea.l    (a0),a1
		move.w     d3,608(a1)
		movea.l    (a3),a0
		jsr        (a0)
call_click_1:
		movem.l    (a7)+,d3/a2-a4
		rts

Ame_titmenu:
		movem.l    d3-d5/a2,-(a7)
		movea.l    a0,a2
		move.w     d0,d5
		move.w     2(a2),d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     2(a2,d2.l),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     2(a2,d1.l),d3
		move.w     4(a2),d0
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     2(a2,d1.l),d4
		bra.s      Ame_titmenu_1
Ame_titmenu_2:
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a2,d0.l),d3
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a2,d0.l),d4
Ame_titmenu_1:
		cmp.w      d5,d3
		bne.s      Ame_titmenu_2
		move.w     d4,d0
		movem.l    (a7)+,d3-d5/a2
		rts

Ame_tnormal:
		movem.l    d3-d4/a2-a3,-(a7)
		subq.w     #8,a7
		movea.l    a0,a3
		movea.l    a1,a2
		move.w     d0,d3
		move.w     d1,d4
		cmpa.l     94(a3),a1
		bne.s      Ame_tnormal_1
		lea.l      (a7),a0
		jsr        Aob_offset
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		adda.l     d0,a2
		tst.w      d4
		beq.s      Ame_tnormal_2
		ori.w      #$0001,10(a2)
		bra.s      Ame_tnormal_3
Ame_tnormal_2:
		andi.w     #$FFFE,10(a2)
Ame_tnormal_3:
		lea.l      (a7),a1
		movea.l    a3,a0
		movea.l    106(a3),a2
		jsr        (a2)
Ame_tnormal_1:
		addq.w     #8,a7
		movem.l    (a7)+,d3-d4/a2-a3
		rts

Ame_menu:
		movem.l    d3-d7/a2-a6,-(a7)
		lea.l      -34(a7),a7
		movea.l    a0,a5
		movea.l    a1,a4
		move.w     d0,32(a7)
		lea.l      12(a7),a2
		lea.l      xd3cf2,a0
		movea.l    a2,a1
		move.l     (a0)+,(a1)+
		move.l     (a0)+,(a1)+
		move.w     32(a7),d0
		movea.l    a4,a0
		bsr        Ame_titmenu
		move.w     d0,d3
		moveq.l    #1,d1
		movea.l    a4,a1
		movea.l    a5,a0
		move.w     32(a7),d0
		bsr        Ame_tnormal
		move.l     _globl,-(a7)
		pea.l      4(a7)
		pea.l      12(a7)
		lea.l      18(a7),a1
		lea.l      20(a7),a0
		jsr        mt_graf_mkstate
		lea.l      12(a7),a7
		moveq.l    #1,d0
		move.w     4(a7),d1
		eor.w      d1,d0
		and.w      #$0001,d0
		move.w     d0,4(a7)
		lea.l      32(a7),a1
		movea.l    a5,a0
		movea.l    4(a5),a3
		moveq.l    #31,d0
		jsr        (a3)
Ame_menu_11:
		lea.l      10(a7),a3
		moveq.l    #-1,d4
		clr.w      d5
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     16(a4,d0.l),2(a7)
		move.w     18(a4,d0.l),d7
		movea.l    a4,a1
		lea.l      20(a7),a0
		move.w     d3,d0
		jsr        Aob_offset
		move.w     20(a7),d0
		bpl.s      Ame_menu_1
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		sub.w      d0,16(a4,d1.l)
		clr.w      20(a7)
Ame_menu_1:
		move.w     22(a7),d0
		bpl.s      Ame_menu_2
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		sub.w      d0,18(a4,d1.l)
		clr.w      22(a7)
Ame_menu_2:
		move.w     20(a7),d6
		add.w      24(a7),d6
		movea.l    ACSblk,a0
		sub.w      8(a0),d6
		sub.w      12(a0),d6
		tst.w      d6
		ble.s      Ame_menu_3
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		sub.w      d6,16(a4,d0.l)
		sub.w      d6,20(a7)
Ame_menu_3:
		move.w     22(a7),d6
		add.w      26(a7),d6
		movea.l    ACSblk,a0
		sub.w      10(a0),d6
		sub.w      14(a0),d6
		tst.w      d6
		ble.s      Ame_menu_4
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		sub.w      d6,18(a4,d0.l)
		sub.w      d6,22(a7)
Ame_menu_4:
		lea.l      20(a7),a0
		jsr        Aob_save
		move.l     a0,28(a7)
		move.w     26(a7),-(a7)
		move.w     26(a7),-(a7)
		move.w     26(a7),-(a7)
		movea.l    _globl,a1
		move.w     26(a7),d2
		moveq.l    #6,d1
		move.w     d3,d0
		movea.l    a4,a0
		jsr        mt_objc_draw
		addq.w     #6,a7
Ame_menu_12:
		moveq.l    #3,d0
		jsr        Awi_update
		move.l     _globl,-(a7)
		pea.l      4(a7)
		pea.l      8(a7)
		pea.l      12(a7)
		pea.l      16(a7)
		pea.l      26(a7)
		clr.l      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		moveq.l    #1,d0
		move.w     d0,-(a7)
		move.w     d0,-(a7)
		move.w     48(a7),-(a7)
		move.w     52(a7),-(a7)
		move.w     d0,-(a7)
		move.w     52(a7),-(a7)
		lea.l      58(a7),a1
		suba.l     a0,a0
		move.w     d0,d2
		move.w     d0,d1
		moveq.l    #6,d0
		jsr        mt_evnt_multi
		lea.l      50(a7),a7
		move.w     d0,d6
		moveq.l    #2,d0
		jsr        Awi_update
		move.w     6(a7),-(a7)
		move.w     10(a7),d2
		moveq.l    #1,d1
		move.w     d3,d0
		movea.l    a4,a0
		jsr        Adr_find
		addq.w     #2,a7
		move.w     d0,(a3)
		cmp.w      d0,d3
		bne.s      Ame_menu_5
		move.w     #$FFFF,(a3)
Ame_menu_5:
		cmp.w      (a3),d4
		beq        Ame_menu_6
		movea.l    _globl,a1
		suba.l     a0,a0
		move.w     #$0100,d0
		jsr        mt_graf_mouse
		tst.w      d5
		beq.s      Ame_menu_7
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		ori.w      #$0001,10(a4,d0.l)
		moveq.l    #1,d2
		move.w     d2,-(a7)
		move.w     10(a4,d0.l),d1
		and.w      #$FFFE,d1
		move.w     d1,-(a7)
		move.w     6(a2),-(a7)
		move.w     4(a2),-(a7)
		move.w     2(a2),-(a7)
		movea.l    _globl,a1
		movea.l    a4,a0
		move.w     d4,d0
		clr.w      d1
		move.w     (a2),d2
		jsr        mt_objc_change
		lea.l      10(a7),a7
Ame_menu_7:
		move.w     (a3),d0
		bmi.w      Ame_menu_8
		moveq.l    #8,d1
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		and.w      10(a4,d2.l),d1
		bne.s      Ame_menu_8
		movea.l    a4,a1
		movea.l    a2,a0
		move.w     (a3),d0
		jsr        Aob_offset
		moveq.l    #1,d0
		move.w     d0,-(a7)
		moveq.l    #1,d1
		move.w     (a3),d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		or.w       10(a4,d2.l),d1
		move.w     d1,-(a7)
		move.w     6(a2),-(a7)
		move.w     4(a2),-(a7)
		move.w     2(a2),-(a7)
		movea.l    _globl,a1
		movea.l    a4,a0
		move.w     (a3),d0
		clr.w      d1
		move.w     (a2),d2
		jsr        mt_objc_change
		lea.l      10(a7),a7
		move.w     (a3),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		andi.w     #$FFFE,10(a4,d0.l)
		moveq.l    #1,d5
		movea.l    a3,a1
		moveq.l    #32,d0
		movea.l    a5,a0
		movea.l    4(a5),a6
		jsr        (a6)
		bra.s      Ame_menu_9
Ame_menu_8:
		clr.w      d5
Ame_menu_9:
		movea.l    _globl,a1
		suba.l     a0,a0
		move.w     #$0101,d0
		jsr        mt_graf_mouse
		move.w     (a3),d4
Ame_menu_6:
		move.w     (a3),d0
		bpl        Ame_menu_10
		move.w     6(a7),-(a7)
		move.w     10(a7),d2
		moveq.l    #8,d1
		move.w     2(a4),d0
		movea.l    a4,a0
		jsr        Adr_find
		addq.w     #2,a7
		move.w     d0,(a3)
		tst.w      d0
		bmi        Ame_menu_10
		move.l     _globl,-(a7)
		pea.l      4(a7)
		pea.l      12(a7)
		lea.l      18(a7),a1
		lea.l      20(a7),a0
		jsr        mt_graf_mkstate
		lea.l      12(a7),a7
		moveq.l    #1,d0
		move.w     4(a7),d1
		eor.w      d1,d0
		and.w      #$0001,d0
		move.w     d0,4(a7)
		move.w     (a3),d1
		cmp.w      32(a7),d1
		beq.s      Ame_menu_10
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		cmpi.b     #$20,7(a4,d2.l)
		bne.s      Ame_menu_10
		lea.l      20(a7),a1
		movea.l    28(a7),a0
		jsr        Aob_restore
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a7),16(a4,d0.l)
		move.w     d7,18(a4,d0.l)
		movea.l    a4,a1
		movea.l    a5,a0
		move.w     32(a7),d0
		clr.w      d1
		bsr        Ame_tnormal
		move.w     (a3),32(a7)
		move.w     32(a7),d0
		movea.l    a4,a0
		bsr        Ame_titmenu
		move.w     d0,d3
		moveq.l    #1,d1
		movea.l    a4,a1
		movea.l    a5,a0
		move.w     32(a7),d0
		bsr        Ame_tnormal
		lea.l      32(a7),a1
		moveq.l    #32,d0
		movea.l    a5,a0
		movea.l    4(a5),a6
		jsr        (a6)
		bra        Ame_menu_11
Ame_menu_10:
		move.w     (a3),d0
		cmp.w      32(a7),d0
		beq        Ame_menu_12
		moveq.l    #2,d1
		and.w      d6,d1
		beq        Ame_menu_12
		lea.l      20(a7),a1
		movea.l    28(a7),a0
		jsr        Aob_restore
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a7),16(a4,d0.l)
		move.w     d7,18(a4,d0.l)
		jsr        Aev_release
		move.w     (a3),d0
		ble.s      Ame_menu_13
		cmp.w      2(a4),d0
		beq.s      Ame_menu_13
		cmp.w      4(a4),d0
		beq.s      Ame_menu_13
		move.w     2(a4),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		cmp.w      2(a4,d1.l),d0
		beq.s      Ame_menu_13
		jsr        Amo_busy
		move.w     (a3),d0
		movea.l    a4,a1
		movea.l    a5,a0
		bsr        call_click
		jsr        Amo_unbusy
Ame_menu_13:
		clr.w      d1
		move.w     32(a7),d0
		movea.l    a4,a1
		movea.l    a5,a0
		bsr        Ame_tnormal
		suba.l     a1,a1
		moveq.l    #33,d0
		movea.l    a5,a0
		movea.l    4(a5),a2
		jsr        (a2)
		lea.l      34(a7),a7
		movem.l    (a7)+,d3-d7/a2-a6
		rts

Ame_submenu:
		movem.l    d3-d7/a2-a5,-(a7)
		lea.l      -58(a7),a7
		movea.l    a0,a4
		move.w     d0,56(a7)
		lea.l      xd3cfa,a1
		lea.l      36(a7),a0
		move.l     (a1)+,(a0)+
		move.l     (a1)+,(a0)+
		move.w     #$0001,4(a7)
		lea.l      26(a7),a3
		move.w     #$FFFF,(a3)
		clr.w      18(a7)
		move.w     56(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a4,d0.l),d6
		tst.w      d6
		bmi.s      Ame_submenu_1
		bra.s      Ame_submenu_2
Ame_submenu_4:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a4,d0.l),d6
Ame_submenu_2:
		cmp.w      56(a7),d6
		beq.s      Ame_submenu_3
		moveq.l    #4,d0
		move.w     d6,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		and.w      10(a4,d1.l),d0
		beq.s      Ame_submenu_4
Ame_submenu_3:
		cmp.w      56(a7),d6
		beq.s      Ame_submenu_1
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     16(a4,d0.l),d2
		move.w     56(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		sub.w      d2,16(a4,d0.l)
		move.w     d6,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     18(a4,d2.l),d1
		move.w     56(a7),d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		sub.w      d1,18(a4,d2.l)
Ame_submenu_1:
		move.w     56(a7),d0
		movea.l    a4,a1
		lea.l      44(a7),a0
		jsr        Aob_offset
		movea.l    ACSblk,a0
		move.w     44(a7),d0
		cmp.w      8(a0),d0
		bge.s      Ame_submenu_5
		move.w     56(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     8(a0),16(a4,d1.l)
		movea.l    ACSblk,a0
		move.w     8(a0),44(a7)
Ame_submenu_5:
		movea.l    ACSblk,a0
		move.w     46(a7),d0
		cmp.w      10(a0),d0
		bge.s      Ame_submenu_6
		move.w     56(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     10(a0),18(a4,d1.l)
		movea.l    ACSblk,a0
		move.w     10(a0),46(a7)
Ame_submenu_6:
		move.w     44(a7),d0
		add.w      48(a7),d0
		movea.l    ACSblk,a0
		sub.w      8(a0),d0
		sub.w      12(a0),d0
		move.w     d0,2(a7)
		tst.w      d0
		ble.s      Ame_submenu_7
		move.w     56(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		sub.w      d0,16(a4,d1.l)
		sub.w      d0,44(a7)
Ame_submenu_7:
		move.w     46(a7),d0
		add.w      50(a7),d0
		movea.l    ACSblk,a0
		sub.w      10(a0),d0
		sub.w      14(a0),d0
		move.w     d0,2(a7)
		tst.w      d0
		ble.s      Ame_submenu_8
		move.w     56(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		sub.w      d0,18(a4,d1.l)
		sub.w      d0,46(a7)
Ame_submenu_8:
		lea.l      44(a7),a0
		jsr        Aob_save
		move.l     a0,52(a7)
		jsr        Amo_hide
		move.w     50(a7),-(a7)
		move.w     50(a7),-(a7)
		move.w     50(a7),-(a7)
		movea.l    _globl,a1
		move.w     50(a7),d2
		moveq.l    #6,d1
		move.w     62(a7),d0
		movea.l    a4,a0
		jsr        mt_objc_draw
		addq.w     #6,a7
		jsr        Amo_show
		move.l     _globl,-(a7)
		pea.l      4(a7)
		pea.l      16(a7)
		lea.l      24(a7),a1
		lea.l      26(a7),a0
		jsr        mt_graf_mkstate
		lea.l      12(a7),a7
		addq.w     #1,14(a7)
		lea.l      22(a7),a2
		moveq.l    #1,d0
		and.w      8(a7),d0
		beq.s      Ame_submenu_9
		move.w     #$0001,6(a7)
		bra        Ame_submenu_10
Ame_submenu_9:
		clr.w      6(a7)
		bra        Ame_submenu_10
Ame_submenu_72:
		moveq.l    #3,d0
		jsr        Awi_update
		move.l     _globl,-(a7)
		pea.l      4(a7)
		pea.l      18(a7)
		pea.l      20(a7)
		pea.l      16(a7)
		pea.l      32(a7)
		clr.l      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		moveq.l    #1,d0
		move.w     d0,-(a7)
		move.w     d0,-(a7)
		move.w     54(a7),-(a7)
		move.w     58(a7),-(a7)
		move.w     d0,-(a7)
		move.w     54(a7),-(a7)
		lea.l      64(a7),a1
		suba.l     a0,a0
		move.w     d0,d2
		movea.l    ACSblk,a5
		move.w     720(a5),d1
		moveq.l    #7,d0
		jsr        mt_evnt_multi
		lea.l      50(a7),a7
		move.w     d0,16(a7)
		moveq.l    #2,d0
		jsr        Awi_update
		moveq.l    #1,d0
		and.w      16(a7),d0
		beq        Ame_submenu_11
		move.w     8(a7),d1
		move.w     10(a7),d0
		jsr        nkc_gemks2n
		move.w     d0,10(a7)
		moveq.l    #-2,d6
		move.w     10(a7),d1
		and.w      #$8000,d1
		beq        Ame_submenu_11
		move.b     11(a7),d2
		ext.w      d2
		cmp.w      #$001B,d2
		bhi        Ame_submenu_12
		add.w      d2,d2
		move.w     J34(pc,d2.w),d2
		jmp        J34(pc,d2.w)
J34:
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_13-J34
		dc.w Ame_submenu_13-J34
		dc.w Ame_submenu_13-J34
		dc.w Ame_submenu_13-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_14-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_14-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_15-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_12-J34
		dc.w Ame_submenu_16-J34
Ame_submenu_16:
		moveq.l    #-1,d6
		bra        Ame_submenu_17
Ame_submenu_14:
		move.w     (a3),d0
		bmi        Ame_submenu_11
		move.w     18(a7),d1
		beq        Ame_submenu_18
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     2(a4,d2.l),d1
		ble        Ame_submenu_18
		move.w     d1,24(a7)
		tst.w      d1
		bmi        Ame_submenu_11
		cmp.w      4(a4,d2.l),d1
		bne        Ame_submenu_11
		moveq.l    #1,d0
		add.w      38(a7),d0
		move.w     d0,-(a7)
		move.w     38(a7),d2
		add.w      42(a7),d2
		subq.w     #2,d2
		movea.l    a4,a0
		move.w     58(a7),d0
		moveq.l    #1,d1
		jsr        Adr_find
		addq.w     #2,a7
		move.w     (a3),d1
		cmp.w      d0,d1
		bne        Ame_submenu_11
		move.w     24(a7),d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		andi.w     #$FF7F,8(a4,d0.l)
		move.w     (a3),d0
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     20(a4,d1.l),d2
		asr.w      #1,d2
		move.w     24(a7),d0
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     d2,16(a4,d1.l)
		clr.w      18(a4,d1.l)
		movea.l    a4,a0
		move.w     24(a7),d0
		bsr        Ame_submenu
		move.w     d0,(a2)
		move.w     24(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		ori.w      #$0080,8(a4,d1.l)
		move.w     (a2),d0
		bmi.s      Ame_submenu_19
		movea.w    56(a7),a0
		cmpa.w     d0,a0
		beq.s      Ame_submenu_20
		movea.l    a4,a0
		jsr        Aob_up
		move.w     56(a7),d1
		cmp.w      d0,d1
		bne.s      Ame_submenu_19
Ame_submenu_20:
		movea.l    a2,a1
		moveq.l    #24,d0
		movea.l    ACSblk,a0
		movea.l    600(a0),a0
		movea.l    ACSblk,a5
		movea.l    600(a5),a5
		movea.l    4(a5),a5
		jsr        (a5)
		bra        Ame_submenu_11
Ame_submenu_18:
		move.w     (a3),(a2)
Ame_submenu_19:
		clr.w      4(a7)
		moveq.l    #-2,d6
		bra        Ame_submenu_11
Ame_submenu_15:
		move.w     56(a7),d0
		beq.s      Ame_submenu_17
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     0(a4,d1.l),d2
		ble.s      Ame_submenu_17
		move.w     d2,20(a7)
		move.w     d2,(a2)
		movea.l    a4,a1
		lea.l      36(a7),a0
		move.w     20(a7),d0
		jsr        Aob_offset
		moveq.l    #1,d0
		add.w      36(a7),d0
		move.w     d0,14(a7)
		moveq.l    #1,d1
		add.w      38(a7),d1
		move.w     d1,12(a7)
		bra        Ame_submenu_21
Ame_submenu_17:
		move.w     #$FFFF,(a2)
		bra        Ame_submenu_21
Ame_submenu_13:
		move.w     (a3),d0
		bpl        Ame_submenu_22
		cmpi.b     #$03,11(a7)
		beq.s      Ame_submenu_23
		cmpi.b     #$02,11(a7)
		bne.s      Ame_submenu_24
Ame_submenu_23:
		move.w     #$7FFF,d3
		move.w     d3,d7
Ame_submenu_24:
		cmpi.b     #$04,11(a7)
		beq.s      Ame_submenu_25
		cmpi.b     #$01,11(a7)
		bne.s      Ame_submenu_26
Ame_submenu_25:
		clr.w      d3
		move.w     d3,d7
Ame_submenu_26:
		move.w     56(a7),(a7)
		bra.s      Ame_submenu_27
Ame_submenu_29:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a4,d0.l),(a7)
Ame_submenu_27:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a4,d0.l),d2
		bmi.s      Ame_submenu_28
		move.w     #$0080,d0
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		and.w      8(a4,d1.l),d0
		beq.s      Ame_submenu_29
Ame_submenu_28:
		move.w     (a7),d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,20(a7)
		moveq.l    #-2,d6
		bra        Ame_submenu_30
Ame_submenu_35:
		move.b     11(a7),d0
		ext.w      d0
		subq.w     #1,d0
		beq.s      Ame_submenu_31
		subq.w     #1,d0
		beq.s      Ame_submenu_32
		subq.w     #1,d0
		beq.s      Ame_submenu_32
		subq.w     #1,d0
		beq.s      Ame_submenu_31
		bra.s      Ame_submenu_33
Ame_submenu_32:
		moveq.l    #8,d0
		move.w     (a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		and.w      10(a4,d1.l),d0
		bne.s      Ame_submenu_33
		moveq.l    #65,d0
		and.w      8(a4,d1.l),d0
		beq.s      Ame_submenu_33
		cmp.w      18(a4,d1.l),d3
		ble.s      Ame_submenu_33
		cmp.w      16(a4,d1.l),d7
		ble.s      Ame_submenu_33
		bra.s      Ame_submenu_34
Ame_submenu_31:
		moveq.l    #8,d0
		move.w     (a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		and.w      10(a4,d1.l),d0
		bne.s      Ame_submenu_33
		moveq.l    #65,d0
		and.w      8(a4,d1.l),d0
		beq.s      Ame_submenu_33
		cmp.w      18(a4,d1.l),d3
		bgt.s      Ame_submenu_33
		cmp.w      16(a4,d1.l),d7
		bgt.s      Ame_submenu_33
Ame_submenu_34:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     18(a4,d0.l),d3
		move.w     16(a4,d0.l),d7
		move.w     (a7),d6
Ame_submenu_33:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a4,d0.l),(a7)
Ame_submenu_30:
		move.w     (a7),d0
		cmp.w      20(a7),d0
		bne        Ame_submenu_35
		bra        Ame_submenu_11
Ame_submenu_22:
		move.w     #$7FFF,d3
		move.w     d3,d7
		move.w     (a3),d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,20(a7)
		move.w     (a3),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     0(a4,d1.l),d0
		cmp.w      20(a7),d0
		bne.s      Ame_submenu_36
		move.w     20(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     2(a4,d1.l),(a7)
		bra.s      Ame_submenu_37
Ame_submenu_36:
		move.w     (a3),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a4,d0.l),(a7)
Ame_submenu_37:
		moveq.l    #-2,d6
		bra        Ame_submenu_38
Ame_submenu_59:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     16(a4,d0.l),d5
		move.w     (a3),d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		sub.w      16(a4,d2.l),d5
		tst.w      d5
		bpl.s      Ame_submenu_39
		neg.w      d5
Ame_submenu_39:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     18(a4,d0.l),d4
		move.w     (a3),d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		sub.w      18(a4,d2.l),d4
		tst.w      d4
		bpl.s      Ame_submenu_40
		neg.w      d4
Ame_submenu_40:
		moveq.l    #8,d0
		move.w     (a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		and.w      10(a4,d1.l),d0
		bne        Ame_submenu_41
		moveq.l    #65,d0
		and.w      8(a4,d1.l),d0
		beq        Ame_submenu_41
		move.b     11(a7),d2
		ext.w      d2
		subq.w     #1,d2
		beq        Ame_submenu_42
		subq.w     #1,d2
		beq.w      Ame_submenu_43
		subq.w     #1,d2
		beq.s      Ame_submenu_44
		subq.w     #1,d2
		beq        Ame_submenu_45
		bra        Ame_submenu_41
Ame_submenu_44:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     16(a4,d0.l),d2
		move.w     (a3),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		cmp.w      16(a4,d0.l),d2
		ble        Ame_submenu_41
		tst.w      d3
		bne.s      Ame_submenu_46
		tst.w      d4
		bne.s      Ame_submenu_46
		cmp.w      d5,d7
		bgt.s      Ame_submenu_47
Ame_submenu_46:
		tst.w      d4
		bne.s      Ame_submenu_48
		tst.w      d3
		bne.s      Ame_submenu_47
Ame_submenu_48:
		tst.w      d3
		beq.s      Ame_submenu_49
		cmp.w      d5,d7
		ble.s      Ame_submenu_49
		cmp.w      d4,d3
		bge.s      Ame_submenu_47
Ame_submenu_49:
		tst.w      d3
		beq        Ame_submenu_41
		cmp.w      d5,d7
		blt        Ame_submenu_41
		cmp.w      d4,d3
		ble        Ame_submenu_41
Ame_submenu_47:
		move.w     d4,d3
		move.w     d5,d7
		move.w     (a7),d6
		bra        Ame_submenu_41
Ame_submenu_43:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     18(a4,d0.l),d2
		move.w     (a3),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		cmp.w      18(a4,d0.l),d2
		ble        Ame_submenu_41
		tst.w      d7
		bne.s      Ame_submenu_50
		tst.w      d4
		bne.s      Ame_submenu_50
		cmp.w      d4,d3
		bgt.s      Ame_submenu_47
Ame_submenu_50:
		tst.w      d7
		beq.s      Ame_submenu_51
		tst.w      d5
		beq.s      Ame_submenu_47
Ame_submenu_51:
		tst.w      d7
		beq.s      Ame_submenu_52
		cmp.w      d4,d3
		ble.s      Ame_submenu_52
		cmp.w      d5,d7
		bge.s      Ame_submenu_47
Ame_submenu_52:
		tst.w      d7
		beq        Ame_submenu_41
		cmp.w      d4,d3
		blt        Ame_submenu_41
Ame_submenu_57:
		cmp.w      d5,d7
		ble        Ame_submenu_41
		bra.s      Ame_submenu_47
Ame_submenu_45:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     16(a4,d0.l),d2
		move.w     (a3),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		cmp.w      16(a4,d0.l),d2
		bge.w      Ame_submenu_41
		tst.w      d3
		bne.s      Ame_submenu_53
		tst.w      d4
		bne.s      Ame_submenu_53
		cmp.w      d5,d7
		bgt        Ame_submenu_47
Ame_submenu_53:
		tst.w      d3
		beq        Ame_submenu_48
		tst.w      d4
		beq        Ame_submenu_47
		bra        Ame_submenu_48
Ame_submenu_42:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     18(a4,d0.l),d2
		move.w     (a3),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		cmp.w      18(a4,d0.l),d2
		bge.s      Ame_submenu_41
		tst.w      d7
		bne.s      Ame_submenu_54
		tst.w      d5
		bne.s      Ame_submenu_54
		cmp.w      d4,d3
		bgt        Ame_submenu_47
Ame_submenu_54:
		tst.w      d7
		beq.s      Ame_submenu_55
		tst.w      d5
		beq        Ame_submenu_47
Ame_submenu_55:
		tst.w      d7
		beq.s      Ame_submenu_56
		cmp.w      d4,d3
		ble.s      Ame_submenu_56
		cmp.w      d5,d7
		bge        Ame_submenu_47
Ame_submenu_56:
		tst.w      d7
		beq.s      Ame_submenu_41
		cmp.w      d4,d3
		bge        Ame_submenu_57
Ame_submenu_41:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a4,d0.l),d2
		cmp.w      20(a7),d2
		bne.s      Ame_submenu_58
		move.w     20(a7),d5
		ext.l      d5
		move.l     d5,d4
		add.l      d4,d4
		add.l      d5,d4
		lsl.l      #3,d4
		move.w     2(a4,d4.l),(a7)
		bra.s      Ame_submenu_38
Ame_submenu_58:
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a4,d0.l),(a7)
Ame_submenu_38:
		move.w     (a7),d0
		cmp.w      (a3),d0
		bne        Ame_submenu_59
		bra.s      Ame_submenu_11
Ame_submenu_12:
		move.w     10(a7),d1
		move.w     8(a7),d0
		movea.l    a4,a0
		jsr        Aob_key
		move.w     d0,(a2)
		tst.w      d0
		ble.s      Ame_submenu_11
Ame_submenu_21:
		clr.w      4(a7)
Ame_submenu_11:
		moveq.l    #4,d0
		and.w      16(a7),d0
		beq.s      Ame_submenu_60
		move.w     12(a7),-(a7)
		move.w     16(a7),d2
		moveq.l    #8,d1
		movea.l    a4,a0
		move.w     58(a7),d0
		jsr        Adr_find
		addq.w     #2,a7
		move.w     d0,d6
Ame_submenu_60:
		cmp.w      (a3),d6
		beq        Ame_submenu_61
		cmp.w      #$FFFE,d6
		beq        Ame_submenu_61
		move.w     18(a7),d0
		beq.s      Ame_submenu_62
		move.w     (a3),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		ori.w      #$0001,10(a4,d1.l)
		jsr        Amo_hide
		moveq.l    #1,d0
		move.w     d0,-(a7)
		move.w     (a3),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     10(a4,d1.l),d4
		and.w      #$FFFE,d4
		move.w     d4,-(a7)
		move.w     46(a7),-(a7)
		move.w     46(a7),-(a7)
		move.w     46(a7),-(a7)
		movea.l    _globl,a1
		movea.l    a4,a0
		move.w     (a3),d0
		clr.w      d1
		move.w     46(a7),d2
		jsr        mt_objc_change
		lea.l      10(a7),a7
		jsr        Amo_show
Ame_submenu_62:
		tst.w      d6
		bmi        Ame_submenu_63
		cmp.w      56(a7),d6
		beq        Ame_submenu_63
		moveq.l    #8,d0
		move.w     d6,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		and.w      10(a4,d1.l),d0
		bne.s      Ame_submenu_63
		moveq.l    #65,d4
		and.w      8(a4,d1.l),d4
		beq.s      Ame_submenu_63
		movea.l    a4,a1
		lea.l      36(a7),a0
		move.w     d6,d0
		jsr        Aob_offset
		jsr        Amo_hide
		moveq.l    #1,d0
		move.w     d0,-(a7)
		moveq.l    #1,d1
		move.w     d6,d4
		ext.l      d4
		move.l     d4,d2
		add.l      d2,d2
		add.l      d4,d2
		lsl.l      #3,d2
		or.w       10(a4,d2.l),d1
		move.w     d1,-(a7)
		move.w     46(a7),-(a7)
		move.w     46(a7),-(a7)
		move.w     46(a7),-(a7)
		movea.l    _globl,a1
		movea.l    a4,a0
		move.w     d6,d0
		clr.w      d1
		move.w     46(a7),d2
		jsr        mt_objc_change
		lea.l      10(a7),a7
		jsr        Amo_show
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		andi.w     #$FFFE,10(a4,d0.l)
		move.w     #$0001,18(a7)
		bra.s      Ame_submenu_64
Ame_submenu_63:
		moveq.l    #-1,d6
		clr.w      18(a7)
Ame_submenu_64:
		move.w     d6,(a3)
		movea.l    a3,a1
		moveq.l    #24,d0
		movea.l    ACSblk,a0
		movea.l    600(a0),a0
		movea.l    ACSblk,a5
		movea.l    600(a5),a5
		movea.l    4(a5),a5
		jsr        (a5)
Ame_submenu_61:
		move.w     18(a7),d0
		beq        Ame_submenu_65
		move.w     d6,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     2(a4,d1.l),d4
		ble        Ame_submenu_65
		move.w     20(a4,d1.l),d4
		asr.w      #1,d4
		move.w     2(a4,d1.l),24(a7)
		move.w     24(a7),d5
		bmi        Ame_submenu_65
		cmp.w      4(a4,d1.l),d5
		bne        Ame_submenu_65
		move.w     12(a7),-(a7)
		move.w     16(a7),d2
		sub.w      d4,d2
		movea.l    a4,a0
		move.w     58(a7),d0
		moveq.l    #1,d1
		jsr        Adr_find
		addq.w     #2,a7
		cmp.w      d0,d6
		bne.w      Ame_submenu_65
		move.w     24(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		andi.w     #$FF7F,8(a4,d0.l)
		move.w     d4,16(a4,d0.l)
		clr.w      18(a4,d0.l)
		movea.l    a4,a0
		move.w     24(a7),d0
		bsr        Ame_submenu
		move.w     d0,(a2)
		move.w     24(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		ori.w      #$0080,8(a4,d1.l)
		move.w     (a2),d0
		bmi.s      Ame_submenu_66
		move.w     56(a7),d4
		cmp.w      d0,d4
		beq.s      Ame_submenu_67
		movea.l    a4,a0
		jsr        Aob_up
		move.w     56(a7),d1
		cmp.w      d0,d1
		beq.s      Ame_submenu_67
Ame_submenu_66:
		clr.w      4(a7)
		bra.s      Ame_submenu_65
Ame_submenu_67:
		movea.l    a2,a1
		moveq.l    #24,d0
		movea.l    ACSblk,a0
		movea.l    600(a0),a0
		movea.l    ACSblk,a5
		movea.l    600(a5),a5
		movea.l    4(a5),a5
		jsr        (a5)
Ame_submenu_65:
		move.w     56(a7),d0
		movea.l    a4,a1
		lea.l      28(a7),a0
		jsr        Aob_offset
		cmp.w      #$FFFF,d6
		bne.w      Ame_submenu_68
		move.w     12(a7),d1
		move.w     14(a7),d0
		lea.l      28(a7),a0
		jsr        Aob_within
		tst.w      d0
		bne.s      Ame_submenu_68
		move.w     56(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a4,d0.l),20(a7)
		bra.s      Ame_submenu_69
Ame_submenu_71:
		move.w     20(a7),d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,d4
		move.w     12(a7),-(a7)
		move.w     16(a7),d2
		moveq.l    #1,d1
		movea.l    a4,a0
		jsr        Adr_find
		addq.w     #2,a7
		move.w     d0,(a2)
		tst.w      d0
		bpl.s      Ame_submenu_70
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     0(a4,d1.l),20(a7)
Ame_submenu_69:
		move.w     20(a7),d0
		bpl.s      Ame_submenu_71
Ame_submenu_70:
		move.w     20(a7),d0
		ble.s      Ame_submenu_68
		move.w     (a2),d1
		bmi.s      Ame_submenu_68
		clr.w      4(a7)
Ame_submenu_68:
		moveq.l    #2,d0
		and.w      16(a7),d0
		beq.s      Ame_submenu_10
		move.w     d6,(a2)
		clr.w      4(a7)
Ame_submenu_10:
		move.w     4(a7),d0
		bne        Ame_submenu_72
		lea.l      44(a7),a1
		movea.l    52(a7),a0
		jsr        Aob_restore
		move.w     (a2),d0
		lea.l      58(a7),a7
		movem.l    (a7)+,d3-d7/a2-a5
		rts

		.globl Ame_popup
Ame_popup:
		movem.l    d3/a2-a5,-(a7)
		lea.l      -30(a7),a7
		movea.l    a0,a4
		movea.l    a1,a2
		move.w     d0,28(a7)
		move.w     d1,26(a7)
		lea.l      (a7),a0
		jsr        Act_save
		movea.l    a2,a0
		jsr        Aob_fix
		lea.l      ACSblk,a3
		move.w     28(a7),d0
		bpl.s      Ame_popup_1
		move.w     26(a7),d1
		bpl.s      Ame_popup_1
		move.l     _globl,-(a7)
		pea.l      28(a7)
		pea.l      32(a7)
		lea.l      38(a7),a1
		lea.l      40(a7),a0
		jsr        mt_graf_mkstate
		lea.l      12(a7),a7
		movea.l    (a3),a0
		move.w     18(a0),d0
		asr.w      #1,d0
		sub.w      d0,28(a7)
		move.w     20(a0),d1
		asr.w      #1,d1
		sub.w      d1,26(a7)
Ame_popup_1:
		move.w     28(a7),16(a2)
		move.w     26(a7),18(a2)
		movea.l    (a3),a1
		lea.l      608(a1),a1
		moveq.l    #23,d0
		movea.l    (a3),a0
		movea.l    600(a0),a0
		movea.l    (a3),a5
		movea.l    600(a5),a5
		movea.l    4(a5),a5
		jsr        (a5)
		clr.w      d0
		movea.l    a2,a0
		bsr        Ame_submenu
		move.w     d0,d3
		suba.l     a1,a1
		movea.l    (a3),a0
		movea.l    600(a0),a0
		movea.l    (a3),a5
		movea.l    600(a5),a5
		movea.l    4(a5),a5
		moveq.l    #25,d0
		jsr        (a5)
		jsr        Aev_release
		tst.w      d3
		ble.s      Ame_popup_2
		jsr        Amo_busy
		move.w     d3,d0
		movea.l    a2,a1
		movea.l    a4,a0
		bsr        call_click
		jsr        Amo_unbusy
Ame_popup_2:
		tst.w      d3
		bne.s      Ame_popup_3
		moveq.l    #-1,d3
Ame_popup_3:
		lea.l      (a7),a0
		jsr        Act_restore
		move.w     d3,d0
		lea.l      30(a7),a7
		movem.l    (a7)+,d3/a2-a5
		rts

		.globl Ame_root
Ame_root:
		movem.l    d3-d4/a2-a3,-(a7)
		move.w     d0,d3
		move.w     d1,d4
		jsr        Awi_root
		movea.l    a0,a2
		movea.l    94(a2),a3
		jsr        Amo_busy
		cmp.w      #$0003,d3
		bne.s      Ame_root_1
		movea.l    ACSblk,a0
		movea.l    668(a0),a0
		jsr        (a0)
		bra.s      Ame_root_2
Ame_root_1:
		move.w     d4,d0
		movea.l    a3,a1
		movea.l    a2,a0
		bsr        call_click
Ame_root_2:
		jsr        Amo_unbusy
		movea.l    _globl,a1
		moveq.l    #1,d1
		move.w     d3,d0
		movea.l    a3,a0
		jsr        mt_menu_tnormal
		movem.l    (a7)+,d3-d4/a2-a3
		rts

		.globl Ame_drop
Ame_drop:
		movem.l    d3-d5/a2-a3,-(a7)
		subq.w     #8,a7
		movea.l    a0,a2
		move.w     d0,d5
		move.w     d1,d3
		movea.l    94(a2),a3
		move.l     a3,d2
		beq.s      Ame_drop_1
		move.w     16(a3),(a7)
		move.w     18(a3),2(a7)
		move.w     20(a3),d2
		cmp.w      56(a2),d2
		bge.s      Ame_drop_2
		bra.s      Ame_drop_3
Ame_drop_2:
		move.w     56(a2),d2
Ame_drop_3:
		move.w     d2,4(a7)
		move.w     22(a3),6(a7)
		move.w     d3,d1
		move.w     d5,d0
		lea.l      (a7),a0
		jsr        Aob_within
		tst.w      d0
		beq.s      Ame_drop_1
		move.w     2(a3),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a3,d0.l),d4
		move.w     d3,-(a7)
		move.w     d5,d2
		movea.l    a3,a0
		move.w     d4,d0
		moveq.l    #1,d1
		jsr        Adr_find
		addq.w     #2,a7
		move.w     d0,d5
		cmp.w      d0,d4
		bge.s      Ame_drop_1
		movea.l    a3,a1
		movea.l    a2,a0
		bsr        Ame_menu
Ame_drop_1:
		addq.w     #8,a7
		movem.l    (a7)+,d3-d5/a2-a3
		rts

		.globl Ame_key
Ame_key:
		movem.l    d3-d7/a2-a3,-(a7)
		subq.w     #4,a7
		movea.l    a0,a2
		move.w     d0,d3
		move.w     d1,2(a7)
		movea.l    94(a2),a3
		move.l     a3,d2
		beq        Ame_key_1
		movea.l    a3,a0
		jsr        Aob_key
		move.w     d0,d4
		tst.w      d0
		bmi.s      Ame_key_1
		move.w     2(a3),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     2(a3,d1.l),(a7)
		move.w     (a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a3,d0.l),d6
		move.w     4(a3),d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     2(a3,d2.l),d7
		move.w     d4,d3
Ame_key_2:
		move.w     d3,d5
		move.w     d5,d0
		movea.l    a3,a0
		jsr        Aob_up
		move.w     d0,d3
		tst.w      d0
		bmi.s      Ame_key_1
		cmp.w      4(a3),d0
		bne.s      Ame_key_2
		bra.s      Ame_key_3
Ame_key_5:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a3,d0.l),d6
		move.w     d7,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a3,d0.l),d7
		cmp.w      (a7),d6
		bne.s      Ame_key_3
Ame_key_1:
		moveq.l    #-1,d0
		bra.s      Ame_key_4
Ame_key_3:
		cmp.w      d7,d5
		bne.s      Ame_key_5
		jsr        Amo_busy
		move.w     32(a2),d0
		bne.s      Ame_key_6
		movea.l    _globl,a1
		clr.w      d1
		movea.l    a3,a0
		move.w     d6,d0
		jsr        mt_menu_tnormal
		move.w     d4,d0
		movea.l    a3,a1
		movea.l    a2,a0
		bsr        call_click
		movea.l    _globl,a1
		moveq.l    #1,d1
		move.w     d6,d0
		movea.l    a3,a0
		jsr        mt_menu_tnormal
		bra.s      Ame_key_7
Ame_key_6:
		moveq.l    #1,d1
		move.w     d6,d0
		movea.l    a3,a1
		movea.l    a2,a0
		bsr        Ame_tnormal
		move.w     d4,d0
		movea.l    a3,a1
		movea.l    a2,a0
		bsr        call_click
		clr.w      d1
		move.w     d6,d0
		movea.l    a3,a1
		movea.l    a2,a0
		bsr        Ame_tnormal
Ame_key_7:
		jsr        Amo_unbusy
		move.w     d4,d0
Ame_key_4:
		addq.w     #4,a7
		movem.l    (a7)+,d3-d7/a2-a3
		rts

		.globl Ame_namefix
Ame_namefix:
		movem.l    d3-d7/a2-a4,-(a7)
		subq.w     #4,a7
		movea.l    a0,a2
		clr.w      (a7)
		move.w     2(a2),d4
		lea.l      ACSblk,a3
		movea.l    (a3),a0
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     12(a0),20(a2,d0.l)
		move.w     2(a2,d0.l),d4
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     2(a2,d0.l),d5
		move.w     4(a2),d6
		move.w     d6,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     2(a2,d2.l),d6
		move.w     d5,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		move.w     16(a2,d0.l),d7
		move.w     d6,d0
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     16(a2,d1.l),2(a7)
Ame_namefix_7:
		move.w     d5,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    12(a2,d0.l),a4
		movea.l    a4,a0
		jsr        strlen
		move.l     d0,d3
		lea.l      -1(a4,d3.w),a0
		bra.s      Ame_namefix_1
Ame_namefix_3:
		subq.w     #1,d3
		subq.w     #1,a0
Ame_namefix_1:
		tst.w      d3
		ble.s      Ame_namefix_2
		cmpi.b     #$20,(a0)
		beq.s      Ame_namefix_3
		bra.s      Ame_namefix_2
Ame_namefix_5:
		subq.w     #1,d3
		addq.w     #1,a4
Ame_namefix_2:
		tst.w      d3
		ble.s      Ame_namefix_4
		cmpi.b     #$20,(a4)
		beq.s      Ame_namefix_5
Ame_namefix_4:
		moveq.l    #2,d0
		add.w      d3,d0
		movea.l    (a3),a0
		muls.w     18(a0),d0
		move.w     d5,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,20(a2,d1.l)
		move.w     d0,d3
		add.w      d0,(a7)
		move.w     d7,16(a2,d1.l)
		move.w     d6,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     2(a7),16(a2,d2.l)
		add.w      d3,d7
		add.w      d3,2(a7)
		move.w     0(a2,d1.l),d5
		cmp.w      d5,d4
		beq.s      Ame_namefix_6
		move.w     0(a2,d2.l),d6
		bra        Ame_namefix_7
Ame_namefix_6:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     (a7),20(a2,d0.l)
		addq.w     #4,a7
		movem.l    (a7)+,d3-d7/a2-a4
		rts

		.data

xd3cf2:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
xd3cfa:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000

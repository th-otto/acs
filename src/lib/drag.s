
		.globl dotted_xline
dotted_xline:
		movem.l    d3-d5/a2-a3,-(a7)
		subq.w     #8,a7
		move.w     d0,d4
		move.w     d1,d5
		move.w     d2,d3
		lea.l      ACSblk,a2
		movea.l    (a2),a0
		cmp.w      10(a0),d3
		ble.w      dotted_xline_1
		lea.l      pattern,a3
		moveq.l    #1,d0
		and.w      d3,d0
		beq.s      dotted_xline_2
		cmpi.w     #$AAAA,(a3)
		beq.s      dotted_xline_3
		move.w     #$AAAA,(a3)
		move.w     #$AAAA,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
		bra.s      dotted_xline_3
dotted_xline_2:
		cmpi.w     #$5555,(a3)
		beq.s      dotted_xline_3
		move.w     #$5555,(a3)
		move.w     #$5555,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
dotted_xline_3:
		move.w     d4,(a7)
		move.w     d5,4(a7)
		move.w     d3,6(a7)
		move.w     d3,2(a7)
		moveq.l    #7,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    (a2),a1
		move.w     16(a1),d0
		jsr        v_pline
dotted_xline_1:
		addq.w     #8,a7
		movem.l    (a7)+,d3-d5/a2-a3
		rts

		.globl dotted_yline
dotted_yline:
		movem.l    d3-d5/a2-a3,-(a7)
		subq.w     #8,a7
		move.w     d0,d4
		move.w     d1,d5
		move.w     d2,d3
		lea.l      ACSblk,a2
		movea.l    (a2),a0
		cmp.w      8(a0),d3
		ble        dotted_yline_1
		lea.l      pattern,a3
		move.w     d4,d0
		eor.w      d3,d0
		and.w      #$0001,d0
		beq.s      dotted_yline_2
		cmpi.w     #$AAAA,(a3)
		beq.s      dotted_yline_3
		move.w     #$AAAA,(a3)
		move.w     #$AAAA,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
		bra.s      dotted_yline_3
dotted_yline_2:
		cmpi.w     #$5555,(a3)
		beq.s      dotted_yline_3
		move.w     #$5555,(a3)
		move.w     #$5555,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
dotted_yline_3:
		move.w     d4,2(a7)
		move.w     d5,6(a7)
		move.w     d3,4(a7)
		move.w     d3,(a7)
		moveq.l    #7,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    (a2),a1
		move.w     16(a1),d0
		jsr        v_pline
dotted_yline_1:
		addq.w     #8,a7
		movem.l    (a7)+,d3-d5/a2-a3
		rts

		.globl xline2
xline2:
		movem.l    d3-d5/a2-a3,-(a7)
		subq.w     #8,a7
		move.w     d0,d4
		move.w     d1,d5
		move.w     d2,d3
		lea.l      ACSblk,a2
		movea.l    (a2),a0
		cmp.w      10(a0),d3
		ble.w      xline2_1
		lea.l      pattern,a3
		moveq.l    #1,d0
		and.w      d3,d0
		beq.s      xline2_2
		cmpi.w     #$5555,(a3)
		beq.s      xline2_3
		move.w     #$5555,(a3)
		move.w     #$5555,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
		bra.s      xline2_3
xline2_2:
		cmpi.w     #$AAAA,(a3)
		beq.s      xline2_3
		move.w     #$AAAA,(a3)
		move.w     #$AAAA,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
xline2_3:
		move.w     d4,(a7)
		move.w     d5,4(a7)
		move.w     d3,6(a7)
		move.w     d3,2(a7)
		moveq.l    #7,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    (a2),a1
		move.w     16(a1),d0
		jsr        v_pline
xline2_1:
		addq.w     #8,a7
		movem.l    (a7)+,d3-d5/a2-a3
		rts

		.globl yline2
yline2:
		movem.l    d3-d5/a2-a3,-(a7)
		subq.w     #8,a7
		move.w     d0,d4
		move.w     d1,d5
		move.w     d2,d3
		lea.l      ACSblk,a2
		movea.l    (a2),a0
		cmp.w      8(a0),d3
		ble        yline2_1
		lea.l      pattern,a3
		move.w     d4,d0
		eor.w      d3,d0
		and.w      #$0001,d0
		beq.s      yline2_2
		cmpi.w     #$5555,(a3)
		beq.s      yline2_3
		move.w     #$5555,(a3)
		move.w     #$5555,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
		bra.s      yline2_3
yline2_2:
		cmpi.w     #$AAAA,(a3)
		beq.s      yline2_3
		move.w     #$AAAA,(a3)
		move.w     #$AAAA,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_udsty
yline2_3:
		move.w     d4,2(a7)
		move.w     d5,6(a7)
		move.w     d3,4(a7)
		move.w     d3,(a7)
		moveq.l    #7,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    (a2),a1
		move.w     16(a1),d0
		jsr        v_pline
yline2_1:
		addq.w     #8,a7
		movem.l    (a7)+,d3-d5/a2-a3
		rts

drag_set:
		movem.l    d3-d4/a2-a3/a5,-(a7)
		subq.w     #4,a7
		clr.w      d3
		lea.l      2(a7),a5
		lea.l      drags,a2
		bra        drag_set_1
drag_set_8:
		cmp.w      #$0200,d3
		bge        drag_set_2
		move.w     d3,d0
		ext.l      d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    596(a0),a1
		move.w     0(a1,d0.l),d4
		move.w     d4,d1
		and.w      #$1000,d1
		beq.s      drag_set_3
		movea.l    576(a0),a1
		movea.l    24(a1),a3
		and.w      #$0FFF,d4
		bra.s      drag_set_4
drag_set_3:
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		movea.l    20(a1),a3
drag_set_4:
		move.l     _globl,-(a7)
		pea.l      4(a7)
		movea.l    a5,a1
		move.w     d4,d0
		movea.l    a3,a0
		jsr        mt_objc_offset
		addq.w     #8,a7
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		move.w     52(a1),d0
		add.w      d0,(a5)
		move.w     54(a1),d1
		add.w      d1,(a7)
		move.w     d4,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     6(a3,d2.l),d0
		and.w      #$00FF,d0
		cmp.w      #$001F,d0
		beq.s      drag_set_5
		cmp.w      #$0021,d0
		bne.s      drag_set_6
drag_set_5:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    12(a3,d0.l),a0
		move.w     (a5),d2
		add.w      26(a0),d2
		move.w     d3,d0
		lsl.w      #4,d0
		move.w     d2,0(a2,d0.w)
		move.w     (a5),d1
		add.w      18(a0),d1
		move.w     d1,4(a2,d0.w)
		move.w     (a5),d2
		add.w      18(a0),d2
		add.w      22(a0),d2
		subq.w     #1,d2
		move.w     d2,8(a2,d0.w)
		move.w     (a5),d1
		add.w      26(a0),d1
		add.w      30(a0),d1
		subq.w     #1,d1
		move.w     d1,12(a2,d0.w)
		move.w     (a7),d2
		add.w      20(a0),d2
		move.w     d2,2(a2,d0.w)
		move.w     (a7),d1
		add.w      28(a0),d1
		move.w     d1,6(a2,d0.w)
		move.w     (a7),d2
		add.w      28(a0),d2
		add.w      32(a0),d2
		subq.w     #1,d2
		move.w     d2,10(a2,d0.w)
		move.w     #$0001,14(a2,d0.w)
		bra.s      drag_set_7
drag_set_6:
		move.w     d3,d0
		lsl.w      #4,d0
		move.w     (a5),0(a2,d0.w)
		move.w     (a7),2(a2,d0.w)
		move.w     (a5),d1
		move.w     d4,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		add.w      20(a3,d2.l),d1
		subq.w     #1,d1
		move.w     d3,d2
		lsl.w      #4,d2
		move.w     d1,4(a2,d2.w)
		move.w     (a7),d1
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		add.w      22(a3,d0.l),d1
		subq.w     #1,d1
		move.w     d3,d0
		lsl.w      #4,d0
		move.w     d1,6(a2,d0.w)
		clr.w      14(a2,d0.w)
drag_set_7:
		addq.w     #1,d3
drag_set_1:
		movea.l    ACSblk,a0
		cmp.w      582(a0),d3
		blt        drag_set_8
drag_set_2:
		addq.w     #4,a7
		movem.l    (a7)+,d3-d4/a2-a3/a5
		rts

drag_draw:
		movem.l    d3-d7/a2/a4,-(a7)
		lea.l      -18(a7),a7
		move.w     d0,16(a7)
		move.w     d1,14(a7)
		lea.l      ACSblk,a2
		moveq.l    #3,d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vswr_mode
		clr.w      d2
		clr.w      d1
		movea.l    (a2),a0
		move.w     16(a0),d0
		jsr        vsl_ends
		movea.l    (a2),a0
		move.w     8(a0),(a7)
		move.w     10(a0),2(a7)
		move.w     8(a0),d0
		add.w      12(a0),d0
		subq.w     #1,d0
		move.w     d0,4(a7)
		move.w     10(a0),d1
		add.w      14(a0),d1
		subq.w     #1,d1
		move.w     d1,6(a7)
		lea.l      (a7),a0
		movea.l    (a2),a1
		move.w     16(a1),d0
		moveq.l    #1,d1
		jsr        vs_clip
		movea.l    _globl,a1
		suba.l     a0,a0
		move.w     #$0100,d0
		jsr        mt_graf_mouse
		lea.l      drags,a4
		clr.w      d3
		move.w     d3,-2(a4)
		bra        drag_draw_1
drag_draw_8:
		cmp.w      #$0200,d3
		bge        drag_draw_2
		move.w     d3,d0
		lsl.w      #4,d0
		cmpi.w     #$0001,14(a4,d0.w)
		bne        drag_draw_3
		move.w     16(a7),d5
		add.w      0(a4,d0.w),d5
		move.w     16(a7),d6
		add.w      4(a4,d0.w),d6
		move.w     16(a7),d1
		add.w      8(a4,d0.w),d1
		move.w     d1,12(a7)
		move.w     16(a7),d2
		add.w      12(a4,d0.w),d2
		move.w     d2,8(a7)
		move.w     14(a7),d7
		add.w      2(a4,d0.w),d7
		move.w     14(a7),d4
		add.w      6(a4,d0.w),d4
		move.w     14(a7),d1
		add.w      10(a4,d0.w),d1
		move.w     d1,10(a7)
		movea.l    (a2),a0
		cmp.w      10(a0),d7
		bge.s      drag_draw_4
		moveq.l    #-2,d7
		add.w      10(a0),d7
drag_draw_4:
		movea.l    (a2),a0
		cmp.w      10(a0),d4
		bge.s      drag_draw_5
		moveq.l    #-2,d4
		add.w      10(a0),d4
drag_draw_5:
		move.w     d7,d2
		move.w     12(a7),d1
		move.w     d6,d0
		bsr        dotted_xline
		move.w     d4,d2
		move.w     d6,d1
		move.w     d5,d0
		bsr        dotted_xline
		move.w     d4,d2
		move.w     8(a7),d1
		move.w     12(a7),d0
		bsr        dotted_xline
		move.w     10(a7),d2
		move.w     8(a7),d1
		move.w     d5,d0
		bsr        dotted_xline
		move.w     d5,d2
		move.w     10(a7),d1
		move.w     d4,d0
		bsr        dotted_yline
		move.w     d6,d2
		move.w     d4,d1
		move.w     d7,d0
		bsr        dotted_yline
		move.w     12(a7),d2
		move.w     d4,d1
		move.w     d7,d0
		bsr        dotted_yline
		move.w     8(a7),d2
		move.w     10(a7),d1
		move.w     d4,d0
		bsr        dotted_yline
		bra.s      drag_draw_6
drag_draw_3:
		move.w     16(a7),d5
		move.w     d3,d0
		lsl.w      #4,d0
		add.w      0(a4,d0.w),d5
		move.w     16(a7),d6
		add.w      4(a4,d0.w),d6
		move.w     14(a7),d7
		add.w      2(a4,d0.w),d7
		move.w     14(a7),d4
		add.w      6(a4,d0.w),d4
		movea.l    (a2),a0
		cmp.w      10(a0),d7
		bge.s      drag_draw_7
		moveq.l    #-2,d7
		add.w      10(a0),d7
drag_draw_7:
		move.w     d7,d2
		move.w     d6,d1
		move.w     d5,d0
		bsr        dotted_xline
		move.w     d4,d2
		move.w     d6,d1
		move.w     d5,d0
		bsr        dotted_xline
		move.w     d5,d2
		move.w     d4,d1
		move.w     d7,d0
		bsr        dotted_yline
		move.w     d6,d2
		move.w     d4,d1
		move.w     d7,d0
		bsr        dotted_yline
drag_draw_6:
		addq.w     #1,d3
drag_draw_1:
		movea.l    (a2),a0
		cmp.w      582(a0),d3
		blt        drag_draw_8
drag_draw_2:
		movea.l    _globl,a1
		suba.l     a0,a0
		move.w     #$0101,d0
		jsr        mt_graf_mouse
		lea.l      (a7),a0
		clr.w      d1
		movea.l    (a2),a1
		move.w     16(a1),d0
		jsr        vs_clip
		clr.w      -2(a4)
		lea.l      18(a7),a7
		movem.l    (a7)+,d3-d7/a2/a4
		rts

		.globl Adr_start
Adr_start:
		movea.l    ACSblk,a0
		clr.w      584(a0)
		rts

		.globl Adr_next
Adr_next:
		lea.l      ACSblk,a0
		movea.l    (a0),a1
		move.w     584(a1),d0
		cmp.w      582(a1),d0
		blt.s      Adr_next_1
		moveq.l    #-1,d0
		rts
Adr_next_1:
		movea.l    (a0),a1
		move.w     584(a1),d0
		addq.w     #1,584(a1)
		ext.l      d0
		add.l      d0,d0
		movea.l    (a0),a1
		movea.l    596(a1),a1
		move.w     0(a1,d0.l),d0
		rts

		.globl Adr_add
Adr_add:
		movem.l    d3/a2-a4,-(a7)
		subq.w     #2,a7
		movea.l    a0,a2
		move.w     d0,d3
		lea.l      ACSblk,a3
		movea.l    (a3),a0
		cmpa.l     576(a0),a2
		beq.s      Adr_add_1
		jsr        Adr_unselect
		movea.l    (a3),a0
		move.l     a2,576(a0)
Adr_add_1:
		move.w     d3,d0
		and.w      #$1000,d0
		beq.s      Adr_add_2
		movea.l    24(a2),a4
		bra.s      Adr_add_3
Adr_add_2:
		movea.l    20(a2),a4
Adr_add_3:
		clr.w      d0
		bra.s      Adr_add_4
Adr_add_6:
		move.w     d0,d1
		ext.l      d1
		add.l      d1,d1
		movea.l    (a3),a0
		movea.l    596(a0),a1
		cmp.w      0(a1,d1.l),d3
		beq.s      Adr_add_5
		addq.w     #1,d0
Adr_add_4:
		movea.l    (a3),a0
		cmp.w      582(a0),d0
		blt.s      Adr_add_6
		move.w     582(a0),d0
		cmp.w      580(a0),d0
		bge.s      Adr_add_5
		moveq.l    #1,d1
		move.w     d3,d0
		and.w      #$0FFF,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		or.w       10(a4,d2.l),d1
		movea.l    102(a2),a1
		movea.l    a2,a0
		move.w     d3,d0
		jsr        (a1)
		movea.l    (a3),a0
		move.w     582(a0),d0
		addq.w     #1,582(a0)
		ext.l      d0
		add.l      d0,d0
		movea.l    (a3),a0
		movea.l    596(a0),a1
		move.w     d3,0(a1,d0.l)
		move.w     d3,(a7)
		lea.l      (a7),a1
		moveq.l    #5,d0
		movea.l    a2,a0
		movea.l    4(a2),a3
		jsr        (a3)
Adr_add_5:
		addq.w     #2,a7
		movem.l    (a7)+,d3/a2-a4
		rts

		.globl Adr_del
Adr_del:
		movem.l    d3-d4/a2-a5,-(a7)
		subq.w     #6,a7
		movea.l    a0,a2
		move.w     d0,d3
		lea.l      ACSblk,a3
		movea.l    (a3),a0
		cmpa.l     576(a0),a2
		bne        Adr_del_1
		move.w     d3,d0
		and.w      #$1000,d0
		beq.s      Adr_del_2
		move.l     24(a2),(a7)
		bra.s      Adr_del_3
Adr_del_2:
		move.l     20(a2),(a7)
Adr_del_3:
		movea.l    (a3),a0
		move.w     582(a0),d4
		movea.l    596(a0),a5
		bra        Adr_del_4
Adr_del_9:
		cmp.w      (a5),d3
		bne        Adr_del_5
		move.w     d3,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		movea.l    (a7),a0
		move.w     10(a0,d0.l),d1
		and.w      #$FFFE,d1
		movea.l    102(a2),a1
		movea.l    a2,a0
		move.w     d3,d0
		jsr        (a1)
		movea.l    (a3),a0
		move.w     582(a0),d0
		sub.w      d4,d0
		cmp.w      584(a0),d0
		bge.s      Adr_del_6
		subq.w     #1,584(a0)
Adr_del_6:
		movea.l    (a3),a0
		subq.w     #1,582(a0)
		move.w     d4,d0
		lsl.w      #4,d0
		lea.l      drags,a4
		adda.w     d0,a4
		subq.w     #1,d4
		bra.s      Adr_del_7
Adr_del_8:
		move.w     16(a4),(a4)
		move.w     18(a4),2(a4)
		move.w     20(a4),4(a4)
		move.w     22(a4),6(a4)
		move.w     24(a4),8(a4)
		move.w     26(a4),10(a4)
		move.w     28(a4),12(a4)
		move.w     30(a4),14(a4)
		move.w     2(a5),(a5)
		subq.w     #1,d4
		lea.l      -16(a4),a4
		addq.w     #2,a5
Adr_del_7:
		tst.w      d4
		bgt.s      Adr_del_8
		move.w     d3,4(a7)
		lea.l      4(a7),a1
		moveq.l    #6,d0
		movea.l    a2,a0
		movea.l    4(a2),a4
		jsr        (a4)
		bra.s      Adr_del_1
Adr_del_5:
		subq.w     #1,d4
		addq.w     #2,a5
Adr_del_4:
		tst.w      d4
		bgt        Adr_del_9
		movea.l    (a3),a0
		move.w     582(a0),d0
		bne.s      Adr_del_1
		clr.l      576(a0)
Adr_del_1:
		addq.w     #6,a7
		movem.l    (a7)+,d3-d4/a2-a5
		rts

		.globl Adr_unselect
Adr_unselect:
		movem.l    d3-d4/a2-a3,-(a7)
		lea.l      ACSblk,a2
		movea.l    (a2),a0
		move.w     582(a0),d0
		ble        Adr_unselect_1
		movea.l    576(a0),a3
		clr.w      d3
		bra.s      Adr_unselect_2
Adr_unselect_5:
		move.w     d3,d0
		ext.l      d0
		add.l      d0,d0
		movea.l    (a2),a0
		movea.l    596(a0),a1
		move.w     0(a1,d0.l),d4
		move.w     d4,d1
		and.w      #$1000,d1
		beq.s      Adr_unselect_3
		move.w     d4,d0
		and.w      #$0FFF,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		movea.l    24(a3),a0
		move.w     10(a0,d2.l),d1
		and.w      #$FFFE,d1
		movea.l    102(a3),a1
		movea.l    a3,a0
		move.w     d4,d0
		jsr        (a1)
		bra.s      Adr_unselect_4
Adr_unselect_3:
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		movea.l    20(a3),a0
		move.w     10(a0,d0.l),d1
		and.w      #$FFFE,d1
		movea.l    102(a3),a1
		movea.l    a3,a0
		move.w     d4,d0
		jsr        (a1)
Adr_unselect_4:
		addq.w     #1,d3
Adr_unselect_2:
		movea.l    (a2),a0
		cmp.w      582(a0),d3
		blt.s      Adr_unselect_5
		clr.w      582(a0)
		movea.l    (a2),a0
		clr.l      576(a0)
		suba.l     a1,a1
		moveq.l    #6,d0
		movea.l    a3,a0
		movea.l    4(a3),a2
		jsr        (a2)
Adr_unselect_1:
		movem.l    (a7)+,d3-d4/a2-a3
		rts

rect_find:
		movem.l    d3-d7/a2-a5,-(a7)
		lea.l      -18(a7),a7
		movea.l    a0,a5
		move.l     a1,14(a7)
		move.w     d0,12(a7)
		move.w     d1,10(a7)
		move.w     d2,8(a7)
		movea.l    58(a7),a4
		movea.l    62(a7),a2
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     2(a1,d2.l),d4
		bmi        rect_find_1
		bra        rect_find_2
rect_find_16:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    14(a7),a3
		adda.l     d0,a3
		move.w     10(a7),d6
		add.w      16(a3),d6
		move.w     d6,d0
		add.w      20(a3),d0
		subq.w     #1,d0
		move.w     8(a7),d3
		add.w      18(a3),d3
		move.w     d3,d5
		add.w      22(a3),d5
		subq.w     #1,d5
		move.w     6(a3),d7
		and.w      #$00FF,d7
		cmp.w      #$001F,d7
		beq.s      rect_find_3
		cmp.w      #$0021,d7
		bne.s      rect_find_4
rect_find_3:
		movea.l    12(a3),a0
		add.w      18(a0),d6
		move.w     d6,d0
		add.w      22(a0),d0
		subq.w     #1,d0
		add.w      20(a0),d3
		move.w     d3,d5
		add.w      24(a0),d5
		subq.w     #1,d5
		move.w     10(a7),d1
		add.w      16(a3),d1
		add.w      26(a0),d1
		move.w     d1,6(a7)
		add.w      30(a0),d1
		subq.w     #1,d1
		move.w     d1,4(a7)
		move.w     8(a7),d2
		add.w      18(a3),d2
		add.w      28(a0),d2
		move.w     d2,2(a7)
		add.w      32(a0),d2
		subq.w     #1,d2
		move.w     d2,(a7)
		bra.s      rect_find_5
rect_find_4:
		moveq.l    #-1,d1
		move.w     d1,(a7)
		move.w     d1,2(a7)
		move.w     d1,4(a7)
		move.w     d1,6(a7)
rect_find_5:
		cmp.w      2(a4),d5
		blt.s      rect_find_6
		move.w     2(a4),d1
		add.w      6(a4),d1
		subq.w     #1,d1
		cmp.w      d1,d3
		bgt.s      rect_find_6
		cmp.w      (a4),d0
		blt.s      rect_find_6
		move.w     (a4),d0
		add.w      4(a4),d0
		subq.w     #1,d0
		cmp.w      d0,d6
		ble.s      rect_find_7
rect_find_6:
		move.w     (a7),d0
		cmp.w      2(a4),d0
		blt.s      rect_find_8
		move.w     2(a4),d1
		add.w      6(a4),d1
		subq.w     #1,d1
		move.w     2(a7),d2
		cmp.w      d1,d2
		bgt.s      rect_find_8
		move.w     4(a7),d5
		cmp.w      (a4),d5
		blt.s      rect_find_8
		move.w     (a4),d0
		add.w      4(a4),d0
		subq.w     #1,d0
		movea.w    6(a7),a0
		cmpa.w     d0,a0
		bgt.s      rect_find_8
rect_find_7:
		move.w     8(a3),d0
		and.w      #$2000,d0
		beq        rect_find_9
		move.w     #$0080,d1
		and.w      8(a3),d1
		bne        rect_find_9
		moveq.l    #8,d2
		and.w      10(a3),d2
		bne        rect_find_9
		movea.l    14(a7),a0
		cmpa.l     20(a5),a0
		bne.s      rect_find_10
		movea.l    a5,a0
		move.w     d4,d0
		bsr        Adr_add
		bra.s      rect_find_9
rect_find_10:
		move.w     d4,d0
		or.w       #$1000,d0
		movea.l    a5,a0
		bsr        Adr_add
		bra.s      rect_find_9
rect_find_8:
		moveq.l    #1,d0
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    14(a7),a0
		and.w      10(a0,d1.l),d0
		beq.s      rect_find_9
		move.l     20(a2),d5
		beq.s      rect_find_11
		clr.w      d7
		bra.s      rect_find_12
rect_find_13:
		move.w     d7,d0
		ext.l      d0
		add.l      d0,d0
		movea.l    20(a2),a0
		move.w     0(a0,d0.l),d1
		and.w      #$0FFF,d1
		cmp.w      d1,d4
		beq.s      rect_find_9
		addq.w     #1,d7
rect_find_12:
		cmp.w      6(a2),d7
		blt.s      rect_find_13
rect_find_11:
		movea.l    14(a7),a0
		cmpa.l     20(a5),a0
		bne.s      rect_find_14
		move.w     d4,d0
		movea.l    a5,a0
		bsr        Adr_del
		bra.s      rect_find_9
rect_find_14:
		move.w     d4,d0
		or.w       #$1000,d0
		movea.l    a5,a0
		bsr        Adr_del
rect_find_9:
		move.w     #$0080,d0
		and.w      8(a3),d0
		bne.s      rect_find_15
		move.l     a2,-(a7)
		move.l     a4,-(a7)
		move.w     d3,d2
		move.w     d6,d1
		movea.l    22(a7),a1
		movea.l    a5,a0
		move.w     d4,d0
		bsr        rect_find
		addq.w     #8,a7
rect_find_15:
		move.w     (a3),d4
rect_find_2:
		cmp.w      12(a7),d4
		bne        rect_find_16
rect_find_1:
		lea.l      18(a7),a7
		movem.l    (a7)+,d3-d7/a2-a5
		rts

		.globl Adr_box
Adr_box:
		movem.l    d3-d7/a2-a6,-(a7)
		lea.l      -66(a7),a7
		move.w     d0,d4
		move.w     d1,d5
		clr.w      36(a7)
		movea.l    _globl,a0
		jsr        mt_wind_find
		jsr        Awi_wid
		movea.l    a0,a2
		move.l     a2,d0
		beq        Adr_box_1
		lea.l      ACSblk,a3
		moveq.l    #3,d0
		movea.l    (a3),a0
		and.w      614(a0),d0
		bne.s      Adr_box_2
		bsr        Adr_unselect
		clr.l      20(a7)
		clr.w      40(a7)
		bra.s      Adr_box_3
Adr_box_2:
		movea.l    (a3),a0
		move.w     580(a0),d0
		ext.l      d0
		add.l      d0,d0
		jsr        Ax_malloc
		move.l     a0,20(a7)
		beq        Adr_box_1
		movea.l    (a3),a1
		move.w     580(a1),d1
		ext.l      d1
		add.l      d1,d1
		clr.w      d0
		jsr        memset
		movea.l    (a3),a0
		move.w     582(a0),d0
		ext.l      d0
		add.l      d0,d0
		movea.l    596(a0),a1
		movea.l    20(a7),a0
		jsr        memcpy
		movea.l    (a3),a0
		move.w     582(a0),d0
		move.w     d0,6(a7)
		move.w     d0,40(a7)
Adr_box_3:
		movea.l    (a3),a0
		move.l     a2,576(a0)
		move.w     52(a2),42(a7)
		move.w     54(a2),44(a7)
		move.w     56(a2),46(a7)
		move.w     58(a2),48(a7)
		move.l     24(a2),d0
		beq.s      Adr_box_4
		cmp.w      54(a2),d5
		blt.s      Adr_box_5
Adr_box_4:
		clr.w      38(a7)
		bra.s      Adr_box_6
Adr_box_5:
		move.w     #$0001,38(a7)
		movea.l    24(a2),a0
		move.w     18(a0),d0
		add.w      d0,44(a7)
		move.w     22(a0),48(a7)
Adr_box_6:
		lea.l      58(a7),a5
		lea.l      50(a7),a4
		move.w     d4,d6
		move.w     d6,32(a7)
		move.w     d6,(a5)
		move.w     d6,(a4)
		move.w     d5,d4
		move.w     d4,30(a7)
		move.w     d4,2(a5)
		move.w     d4,2(a4)
		clr.w      d0
		move.w     d0,6(a5)
		move.w     d0,6(a4)
		move.w     d0,4(a5)
		move.w     d0,4(a4)
		suba.l     a1,a1
		movea.l    a2,a0
		movea.l    4(a2),a6
		moveq.l    #20,d0
		jsr        (a6)
		movea.l    (a3),a0
		movea.l    572(a0),a0
		lea.l      68(a0),a0
		jsr        Amo_new
		moveq.l    #3,d0
		jsr        Awi_update
Adr_box_38:
		jsr        Amo_hide
		moveq.l    #3,d1
		movea.l    (a3),a0
		move.w     16(a0),d0
		jsr        vswr_mode
		move.w     2(a5),d2
		move.w     (a5),d5
		add.w      4(a5),d5
		subq.w     #1,d5
		move.w     d5,d1
		move.w     (a5),d0
		bsr        dotted_xline
		cmp.w      (a5),d5
		beq.s      Adr_box_7
		move.w     2(a5),d7
		add.w      6(a5),d7
		subq.w     #1,d7
		move.w     d7,d2
		move.w     d5,d1
		move.w     (a5),d0
		bsr        dotted_xline
Adr_box_7:
		move.w     (a5),d2
		move.w     d7,d1
		move.w     2(a5),d0
		bsr        dotted_yline
		cmp.w      2(a5),d7
		beq.s      Adr_box_8
		move.w     d5,d2
		move.w     d7,d1
		move.w     2(a5),d0
		bsr        dotted_yline
Adr_box_8:
		jsr        Amo_show
Adr_box_10:
		pea.l      24(a7)
		lea.l      30(a7),a1
		lea.l      32(a7),a0
		movea.l    (a3),a6
		move.w     16(a6),d0
		jsr        vq_mouse
		addq.w     #4,a7
		move.w     36(a7),d0
		bne.s      Adr_box_9
		move.w     28(a7),d1
		beq.s      Adr_box_9
		cmp.w      26(a7),d6
		bne.s      Adr_box_9
		cmp.w      24(a7),d4
		beq.s      Adr_box_10
Adr_box_9:
		jsr        Amo_hide
		moveq.l    #3,d1
		movea.l    (a3),a0
		move.w     16(a0),d0
		jsr        vswr_mode
		move.w     2(a5),d2
		move.w     d5,d1
		move.w     (a5),d0
		bsr        dotted_xline
		cmp.w      (a5),d5
		beq.s      Adr_box_11
		move.w     2(a5),d2
		add.w      6(a5),d2
		subq.w     #1,d2
		move.w     d5,d1
		move.w     (a5),d0
		bsr        dotted_xline
Adr_box_11:
		move.w     (a5),d2
		move.w     d7,d1
		move.w     2(a5),d0
		bsr        dotted_yline
		cmp.w      2(a5),d7
		beq.s      Adr_box_12
		move.w     d5,d2
		move.w     d7,d1
		move.w     2(a5),d0
		bsr        dotted_yline
Adr_box_12:
		jsr        Amo_show
		move.w     28(a7),d0
		beq        Adr_box_13
		move.w     26(a7),d6
		move.w     32(a7),d1
		cmp.w      d6,d1
		bge.s      Adr_box_14
		bra.s      Adr_box_15
Adr_box_14:
		move.w     26(a7),d6
		move.w     d6,d1
Adr_box_15:
		move.w     d1,(a4)
		move.w     24(a7),d4
		move.w     30(a7),d0
		cmp.w      d4,d0
		bge.s      Adr_box_16
		bra.s      Adr_box_17
Adr_box_16:
		move.w     24(a7),d4
		move.w     d4,d0
Adr_box_17:
		move.w     d0,2(a4)
		move.w     d6,d1
		sub.w      32(a7),d1
		move.w     d1,4(a4)
		bpl.s      Adr_box_18
		neg.w      d1
		move.w     d1,4(a4)
Adr_box_18:
		addq.w     #1,4(a4)
		move.w     d4,d0
		sub.w      30(a7),d0
		move.w     d0,6(a4)
		bpl.s      Adr_box_19
		neg.w      d0
		move.w     d0,6(a4)
Adr_box_19:
		addq.w     #1,6(a4)
		clr.w      36(a7)
		move.w     38(a7),d0
		bne        Adr_box_20
		move.w     52(a2),d3
		move.w     60(a2),d1
		ble        Adr_box_21
		cmp.w      d6,d3
		ble        Adr_box_21
		move.w     34(a2),d2
		and.w      #$0A00,d2
		beq        Adr_box_21
		movea.l    20(a2),a0
		move.w     16(a0),34(a7)
		move.w     d3,d5
		sub.w      d6,d5
		addq.w     #1,d5
		ext.l      d5
		move.l     d5,d0
		lsl.l      #5,d0
		sub.l      d5,d0
		lsl.l      #2,d0
		add.l      d5,d0
		lsl.l      #3,d0
		move.w     64(a2),d1
		ext.l      d1
		jsr        _ldiv
		move.w     60(a2),d1
		sub.w      d0,d1
		subq.w     #1,d1
		bge.s      Adr_box_22
		moveq.l    #1,d5
		bra.s      Adr_box_23
Adr_box_22:
		move.w     d3,d1
		sub.w      d6,d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     64(a2),d1
		ext.l      d1
		jsr        _ldiv
		move.w     60(a2),d5
		sub.w      d0,d5
Adr_box_23:
		move.w     60(a2),d0
		sub.w      d5,d0
		move.w     72(a2),d1
		not.w      d1
		and.w      #$00FF,d1
		addq.w     #1,d1
		cmp.w      d1,d0
		bge.s      Adr_box_24
		movea.l    a2,a0
		movea.l    122(a2),a1
		moveq.l    #6,d0
		moveq.l    #1,d1
		jsr        (a1)
		bra.s      Adr_box_25
Adr_box_24:
		move.w     d5,d0
		movea.l    a2,a0
		movea.l    126(a2),a1
		jsr        (a1)
Adr_box_25:
		move.w     34(a7),d7
		neg.w      d7
		movea.l    20(a2),a0
		add.w      16(a0),d7
		add.w      d7,4(a4)
		sub.w      d7,(a4)
		add.w      d7,32(a7)
		move.w     #$0001,36(a7)
Adr_box_21:
		move.w     54(a2),d3
		move.w     62(a2),d0
		ble        Adr_box_26
		cmp.w      d4,d3
		ble        Adr_box_26
		move.w     34(a2),d1
		and.w      #$0140,d1
		beq        Adr_box_26
		movea.l    20(a2),a0
		move.w     18(a0),34(a7)
		move.w     d3,d2
		sub.w      d4,d2
		addq.w     #1,d2
		ext.l      d2
		move.l     d2,d0
		lsl.l      #5,d0
		sub.l      d2,d0
		lsl.l      #2,d0
		add.l      d2,d0
		lsl.l      #3,d0
		move.w     66(a2),d1
		ext.l      d1
		jsr        _ldiv
		move.w     62(a2),d1
		sub.w      d0,d1
		subq.w     #1,d1
		bge.s      Adr_box_27
		moveq.l    #1,d5
		bra.s      Adr_box_28
Adr_box_27:
		move.w     d3,d1
		sub.w      d4,d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     66(a2),d1
		ext.l      d1
		jsr        _ldiv
		move.w     62(a2),d5
		sub.w      d0,d5
Adr_box_28:
		move.w     62(a2),d0
		sub.w      d5,d0
		move.w     72(a2),d1
		not.w      d1
		asr.w      #8,d1
		and.w      #$00FF,d1
		addq.w     #1,d1
		cmp.w      d1,d0
		bge.s      Adr_box_29
		movea.l    a2,a0
		movea.l    122(a2),a1
		moveq.l    #2,d0
		moveq.l    #1,d1
		jsr        (a1)
		bra.s      Adr_box_30
Adr_box_29:
		move.w     d5,d0
		movea.l    a2,a0
		movea.l    130(a2),a1
		jsr        (a1)
Adr_box_30:
		move.w     34(a7),d7
		neg.w      d7
		movea.l    20(a2),a0
		add.w      18(a0),d7
		add.w      d7,6(a4)
		sub.w      d7,2(a4)
		add.w      d7,30(a7)
		move.w     #$0001,36(a7)
Adr_box_26:
		move.w     52(a2),d3
		add.w      56(a2),d3
		subq.w     #1,d3
		cmpi.w     #$03E8,60(a2)
		bge        Adr_box_31
		cmp.w      d3,d6
		ble        Adr_box_31
		move.w     34(a2),d0
		and.w      #$0C00,d0
		beq        Adr_box_31
		movea.l    20(a2),a0
		move.w     16(a0),34(a7)
		move.w     d6,d1
		sub.w      d3,d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     64(a2),d1
		ext.l      d1
		jsr        _ldiv
		add.w      60(a2),d0
		cmp.w      #$03E8,d0
		ble.s      Adr_box_32
		move.w     #$03E8,d5
		bra.s      Adr_box_33
Adr_box_32:
		move.w     d6,d1
		sub.w      d3,d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     64(a2),d1
		ext.l      d1
		jsr        _ldiv
		move.l     d0,d5
		add.w      60(a2),d5
Adr_box_33:
		move.w     d5,d0
		movea.l    a2,a0
		movea.l    126(a2),a1
		jsr        (a1)
		move.w     34(a7),d7
		movea.l    20(a2),a0
		sub.w      16(a0),d7
		sub.w      d7,(a4)
		add.w      d7,4(a4)
		sub.w      d7,32(a7)
		move.w     #$0001,36(a7)
Adr_box_31:
		move.w     54(a2),d3
		add.w      58(a2),d3
		subq.w     #1,d3
		cmpi.w     #$03E8,62(a2)
		bge        Adr_box_20
		cmp.w      d3,d4
		ble        Adr_box_20
		move.w     34(a2),d0
		and.w      #$0180,d0
		beq        Adr_box_20
		movea.l    20(a2),a0
		move.w     18(a0),34(a7)
		move.w     d4,d1
		sub.w      d3,d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     66(a2),d1
		ext.l      d1
		jsr        _ldiv
		add.w      62(a2),d0
		cmp.w      #$03E8,d0
		ble.s      Adr_box_34
		move.w     #$03E8,d5
		bra.s      Adr_box_35
Adr_box_34:
		move.w     d4,d1
		sub.w      d3,d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     66(a2),d1
		ext.l      d1
		jsr        _ldiv
		move.l     d0,d5
		add.w      62(a2),d5
Adr_box_35:
		move.w     d5,d0
		movea.l    a2,a0
		movea.l    130(a2),a1
		jsr        (a1)
		move.w     34(a7),d7
		movea.l    20(a2),a0
		sub.w      18(a0),d7
		sub.w      d7,2(a4)
		add.w      d7,6(a4)
		sub.w      d7,30(a7)
		move.w     #$0001,36(a7)
Adr_box_20:
		move.w     (a4),(a5)
		move.w     2(a4),2(a5)
		move.w     4(a4),4(a5)
		move.w     6(a4),6(a5)
		lea.l      42(a7),a1
		movea.l    a5,a0
		jsr        intersect
		move.w     38(a7),d0
		beq.s      Adr_box_36
		pea.l      (a7)
		pea.l      (a4)
		move.w     54(a2),d2
		movea.l    24(a2),a0
		add.w      18(a0),d2
		move.w     52(a2),d1
		movea.l    a0,a1
		movea.l    a2,a0
		clr.w      d0
		bsr        rect_find
		addq.w     #8,a7
		bra.s      Adr_box_37
Adr_box_36:
		pea.l      (a7)
		pea.l      (a4)
		move.w     54(a2),d2
		movea.l    20(a2),a0
		add.w      18(a0),d2
		move.w     52(a2),d1
		add.w      16(a0),d1
		clr.w      d0
		movea.l    a0,a1
		movea.l    a2,a0
		bsr        rect_find
		addq.w     #8,a7
Adr_box_37:
		movea.l    (a3),a0
		move.w     40(a7),d0
		cmp.w      582(a0),d0
		beq.s      Adr_box_13
		suba.l     a1,a1
		movea.l    4(a2),a6
		movea.l    a2,a0
		moveq.l    #21,d0
		jsr        (a6)
		movea.l    (a3),a0
		move.w     582(a0),40(a7)
Adr_box_13:
		move.w     28(a7),d0
		bne        Adr_box_38
		moveq.l    #2,d0
		jsr        Awi_update
		suba.l     a1,a1
		moveq.l    #22,d0
		movea.l    a2,a0
		movea.l    4(a2),a4
		jsr        (a4)
		move.l     20(a7),d0
		beq.s      Adr_box_39
		movea.l    d0,a0
		jsr        Ax_ifree
Adr_box_39:
		movea.l    (a3),a0
		movea.l    572(a0),a0
		lea.l      56(a0),a0
		jsr        Amo_new
Adr_box_1:
		lea.l      66(a7),a7
		movem.l    (a7)+,d3-d7/a2-a6
		rts

Adr_find0:
		movem.l    d3-d7/a2-a4,-(a7)
		lea.l      -18(a7),a7
		movea.l    a0,a2
		move.w     d0,d3
		move.w     d1,16(a7)
		move.w     d2,d6
		move.w     54(a7),d7
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		lea.l      0(a2,d2.l),a3
		move.w     #$0080,d1
		and.w      8(a3),d1
		bne        Adr_find0_1
		moveq.l    #8,d2
		and.w      10(a3),d2
		bne        Adr_find0_1
		lea.l      8(a7),a4
		move.w     6(a3),d0
		and.w      #$00FF,d0
		cmp.w      #$001F,d0
		beq.s      Adr_find0_2
		cmp.w      #$0021,d0
		bne.s      Adr_find0_3
Adr_find0_2:
		movea.l    12(a3),a0
		move.w     16(a3),d0
		add.w      18(a0),d0
		move.w     d0,(a4)
		move.w     18(a3),d1
		add.w      20(a0),d1
		move.w     d1,2(a4)
		move.w     22(a0),4(a4)
		move.w     24(a0),6(a4)
		move.w     16(a3),d2
		add.w      26(a0),d2
		move.w     d2,(a7)
		move.w     18(a3),d0
		add.w      28(a0),d0
		move.w     d0,2(a7)
		move.w     30(a0),4(a7)
		move.w     32(a0),6(a7)
		movea.l    a4,a0
		move.w     d6,d0
		move.w     d7,d1
		jsr        Aob_within
		tst.w      d0
		bne.s      Adr_find0_4
		move.w     d7,d1
		move.w     d6,d0
		lea.l      (a7),a0
		jsr        Aob_within
		tst.w      d0
		bne.s      Adr_find0_4
		bra.s      Adr_find0_1
Adr_find0_3:
		move.w     16(a3),(a4)
		move.w     18(a3),2(a4)
		move.w     20(a3),4(a4)
		move.w     22(a3),6(a4)
		move.w     d7,d1
		move.w     d6,d0
		movea.l    a4,a0
		jsr        Aob_within
		tst.w      d0
		bne.s      Adr_find0_4
Adr_find0_1:
		moveq.l    #-1,d0
		bra.s      Adr_find0_5
Adr_find0_4:
		move.w     2(a3),d4
		tst.w      d4
		bmi.s      Adr_find0_6
		move.w     16(a7),d0
		ble.s      Adr_find0_6
		sub.w      16(a3),d6
		sub.w      18(a3),d7
		moveq.l    #-1,d5
Adr_find0_8:
		move.w     d7,-(a7)
		move.w     d6,d2
		moveq.l    #-1,d1
		add.w      18(a7),d1
		move.w     d4,d0
		movea.l    a2,a0
		bsr        Adr_find0
		addq.w     #2,a7
		tst.w      d0
		bmi.s      Adr_find0_7
		move.w     d0,d5
Adr_find0_7:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     0(a2,d0.l),d4
		cmp.w      d4,d3
		bne.s      Adr_find0_8
		tst.w      d5
		bmi.s      Adr_find0_6
		move.w     d5,d0
		bra.s      Adr_find0_5
Adr_find0_6:
		move.w     d3,d0
Adr_find0_5:
		lea.l      18(a7),a7
		movem.l    (a7)+,d3-d7/a2-a4
		rts

		.globl Adr_find
Adr_find:
		movem.l    d3-d7/a2,-(a7)
		subq.w     #4,a7
		movea.l    a0,a2
		move.w     d0,d3
		move.w     d1,d6
		move.w     d2,d5
		move.w     32(a7),d4
		tst.w      d0
		bne.s      Adr_find_1
		move.w     d4,-(a7)
		clr.w      d0
		bsr        Adr_find0
		addq.w     #2,a7
		bra.s      Adr_find_2
Adr_find_1:
		move.w     d3,d0
		movea.l    a2,a0
		jsr        Aob_up
		move.w     d0,d7
		move.l     _globl,-(a7)
		pea.l      4(a7)
		lea.l      10(a7),a1
		movea.l    a2,a0
		jsr        mt_objc_offset
		addq.w     #8,a7
		move.w     d4,d0
		sub.w      (a7),d0
		move.w     d0,-(a7)
		move.w     d5,d2
		sub.w      4(a7),d2
		move.w     d6,d1
		movea.l    a2,a0
		move.w     d3,d0
		bsr        Adr_find0
		addq.w     #2,a7
Adr_find_2:
		addq.w     #4,a7
		movem.l    (a7)+,d3-d7/a2
		rts

addDD2Popup:
		movem.l    d3/a2-a3,-(a7)
		movea.l    a0,a3
		movea.l    a1,a2
		moveq.l    #2,d0
		and.l      2(a2),d0
		beq.s      addDD2Popup_1
		movea.l    8(a2),a0
		jsr        strlen
		move.l     d0,d3
		tst.l      d3
		ble.s      addDD2Popup_1
		movea.l    (a3),a0
		jsr        strlen
		add.l      d3,d0
		cmp.l      #$00000100,d0
		bcc.s      addDD2Popup_1
		movea.l    8(a2),a1
		movea.l    (a3),a0
		jsr        strcat
		lea.l      xd3798,a1
		movea.l    (a3),a0
		jsr        strcat
		cmp.l      4(a3),d3
		ble.s      addDD2Popup_1
		move.l     d3,4(a3)
addDD2Popup_1:
		movem.l    (a7)+,d3/a2-a3
		rts

DDCmpName:
		move.l     a2,-(a7)
		move.l     a3,-(a7)
		movea.l    a0,a3
		movea.l    a1,a2
		movea.l    8(a2),a0
		jsr        strlen
		move.l     d0,-(a7)
		movea.l    a3,a0
		jsr        strlen
		cmp.l      (a7)+,d0
		bcc.s      DDCmpName_1
		movea.l    a3,a0
		jsr        strlen
		bra.s      DDCmpName_2
DDCmpName_1:
		movea.l    8(a2),a0
		jsr        strlen
DDCmpName_2:
		movea.l    8(a2),a1
		movea.l    a3,a0
		jsr        strncmp
		tst.w      d0
		bne.s      DDCmpName_3
		moveq.l    #1,d0
		bra.s      DDCmpName_4
DDCmpName_3:
		clr.w      d0
DDCmpName_4:
		movea.l    (a7)+,a3
		movea.l    (a7)+,a2
		rts

		.globl Adr_drag
Adr_drag:
		movem.l    d3-d7/a2-a6,-(a7)
		lea.l      -502(a7),a7
		move.w     d0,354(a7)
		move.w     d1,352(a7)
		lea.l      xd3674,a0
		lea.l      92(a7),a1
		move.w     #$00FF,d2
Adr_drag_1:
		move.b     (a0)+,(a1)+
		dbf        d2,Adr_drag_1
		clr.l      42(a7)
		movea.l    ACSblk,a0
		move.w     582(a0),d2
		ble        Adr_drag_2
		movea.l    576(a0),a3
		move.w     #$0001,(a7)
		move.w     #$0001,2(a7)
		move.w     8(a0),4(a7)
		move.w     8(a0),d1
		add.w      12(a0),d1
		subq.w     #1,d1
		move.w     d1,6(a7)
		move.w     10(a0),8(a7)
		move.w     10(a0),d0
		add.w      12(a0),d0
		subq.w     #1,d0
		move.w     d0,10(a7)
		movea.w    #$0003,a1
		move.w     a1,12(a7)
		move.w     a1,14(a7)
		move.w     a1,16(a7)
		move.w     a1,18(a7)
		move.w     a1,20(a7)
		move.w     a1,22(a7)
		move.w     a1,24(a7)
		move.w     a1,26(a7)
		lea.l      (a7),a1
		movea.l    4(a3),a2
		movea.l    a3,a0
		moveq.l    #18,d0
		jsr        (a2)
		bsr        drag_set
		clr.l      38(a7)
		move.w     354(a7),d0
		ext.l      d0
		divs.w     (a7),d0
		swap       d0
		move.w     d0,32(a7)
		move.w     352(a7),d1
		ext.l      d1
		divs.w     2(a7),d1
		swap       d1
		move.w     d1,30(a7)
		move.w     354(a7),66(a7)
		lea.l      64(a7),a5
		move.w     352(a7),(a5)
		movea.l    ACSblk,a0
		move.w     614(a0),d7
		moveq.l    #3,d0
		and.w      d7,d0
		beq.s      Adr_drag_3
		or.w       #$0003,d7
Adr_drag_3:
		asr.w      #1,d7
		move.w     d7,d0
		add.w      d0,d0
		move.w     12(a7,d0.w),28(a7)
		move.w     28(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		add.l      d1,d1
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      56(a0,d1.l),a0
		jsr        Amo_new
		moveq.l    #-1,d5
Adr_drag_35:
		move.w     66(a7),d0
		sub.w      354(a7),d0
		move.w     d0,62(a7)
		move.w     (a5),d1
		sub.w      352(a7),d1
		move.w     d1,60(a7)
		bsr        drag_draw
Adr_drag_11:
		move.w     66(a7),d3
		move.w     (a5),d4
		move.l     _globl,-(a7)
		pea.l      62(a7)
		pea.l      58(a7)
		movea.l    a5,a1
		lea.l      78(a7),a0
		jsr        mt_graf_mkstate
		lea.l      12(a7),a7
		move.w     58(a7),d7
		moveq.l    #3,d0
		and.w      d7,d0
		beq.s      Adr_drag_4
		or.w       #$0003,d7
Adr_drag_4:
		asr.w      #1,d7
		move.w     d7,d0
		add.w      d0,d0
		move.w     28(a7),d1
		cmp.w      12(a7,d0.w),d1
		beq.s      Adr_drag_5
		move.w     12(a7,d0.w),28(a7)
		move.w     28(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		add.l      d1,d1
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      56(a0,d1.l),a0
		jsr        Amo_new
Adr_drag_5:
		move.w     (a7),d0
		asr.w      #1,d0
		add.w      d0,66(a7)
		move.w     2(a7),d1
		asr.w      #1,d1
		add.w      d1,(a5)
		move.w     66(a7),d2
		cmp.w      4(a7),d2
		bge.s      Adr_drag_6
		move.w     4(a7),66(a7)
Adr_drag_6:
		move.w     66(a7),d0
		cmp.w      6(a7),d0
		ble.s      Adr_drag_7
		move.w     6(a7),66(a7)
Adr_drag_7:
		move.w     (a5),d0
		cmp.w      8(a7),d0
		bge.s      Adr_drag_8
		move.w     8(a7),(a5)
Adr_drag_8:
		move.w     (a5),d0
		cmp.w      10(a7),d0
		ble.s      Adr_drag_9
		move.w     10(a7),(a5)
Adr_drag_9:
		move.w     66(a7),d0
		sub.w      32(a7),d0
		ext.l      d0
		divs.w     (a7),d0
		swap       d0
		sub.w      d0,66(a7)
		move.w     (a5),d0
		sub.w      30(a7),d0
		ext.l      d0
		divs.w     2(a7),d0
		swap       d0
		sub.w      d0,(a5)
		move.w     50(a7),d0
		beq.s      Adr_drag_10
		cmp.w      66(a7),d3
		bne.s      Adr_drag_10
		cmp.w      (a5),d4
		beq        Adr_drag_11
Adr_drag_10:
		move.w     60(a7),d1
		move.w     62(a7),d0
		bsr        drag_draw
		movea.l    _globl,a0
		move.w     (a5),d1
		move.w     66(a7),d0
		jsr        mt_wind_find
		move.w     d0,54(a7)
		jsr        Awi_wid
		movea.l    a0,a3
		move.l     a3,d0
		bne.s      Adr_drag_12
		moveq.l    #1,d4
		bra.s      Adr_drag_13
Adr_drag_12:
		clr.w      d4
Adr_drag_13:
		move.l     a3,d0
		beq        Adr_drag_14
		move.l     20(a3),d1
		bne.s      Adr_drag_15
		move.l     24(a3),d2
		beq        Adr_drag_14
Adr_drag_15:
		move.w     (a5),d0
		sub.w      54(a3),d0
		move.w     d0,-(a7)
		move.w     68(a7),d2
		sub.w      52(a3),d2
		moveq.l    #8,d1
		movea.l    20(a3),a0
		clr.w      d0
		bsr        Adr_find
		addq.w     #2,a7
		move.w     d0,d6
		tst.w      d0
		bpl        Adr_drag_16
		move.l     24(a3),d1
		beq        Adr_drag_16
		move.w     (a5),d2
		sub.w      54(a3),d2
		move.w     d2,-(a7)
		move.w     68(a7),d2
		sub.w      52(a3),d2
		movea.l    d1,a0
		clr.w      d0
		moveq.l    #8,d1
		bsr        Adr_find
		addq.w     #2,a7
		move.w     d0,d6
		tst.w      d0
		bmi        Adr_drag_16
		or.w       #$1000,d6
		bra        Adr_drag_16
Adr_drag_24:
		cmpa.l     38(a7),a3
		bne.s      Adr_drag_17
		cmp.w      d6,d5
		beq        Adr_drag_18
Adr_drag_17:
		move.w     d6,d0
		and.w      #$1000,d0
		beq.s      Adr_drag_19
		move.w     d6,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    24(a3),a2
		adda.l     d1,a2
		bra.s      Adr_drag_20
Adr_drag_19:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    20(a3),a2
		adda.l     d0,a2
Adr_drag_20:
		move.w     8(a2),d0
		and.w      #$1000,d0
		bne.s      Adr_drag_18
		cmpi.b     #$18,7(a2)
		bne.s      Adr_drag_21
		moveq.l    #8,d1
		and.w      8(a2),d1
		bne.s      Adr_drag_18
Adr_drag_21:
		move.w     8(a2),d0
		and.w      #$2000,d0
		beq.s      Adr_drag_22
		moveq.l    #1,d1
		and.w      10(a2),d1
		bne.s      Adr_drag_14
Adr_drag_22:
		move.w     d6,d0
		and.w      #$1000,d0
		beq.s      Adr_drag_23
		move.w     d6,d0
		and.w      #$0FFF,d0
		movea.l    24(a3),a0
		jsr        Aob_up
		or.w       #$1000,d0
		move.w     d0,d6
		bra.s      Adr_drag_16
Adr_drag_23:
		move.w     d6,d0
		movea.l    20(a3),a0
		jsr        Aob_up
		move.w     d0,d6
Adr_drag_16:
		tst.w      d6
		bpl        Adr_drag_24
		bra.s      Adr_drag_18
Adr_drag_14:
		moveq.l    #-1,d6
Adr_drag_18:
		cmp.w      d6,d5
		bne.s      Adr_drag_25
		cmpa.l     38(a7),a3
		beq        Adr_drag_26
Adr_drag_25:
		tst.w      d5
		bmi.s      Adr_drag_27
		move.w     d5,d0
		and.w      #$1000,d0
		beq.s      Adr_drag_28
		move.w     d5,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    38(a7),a0
		movea.l    24(a0),a2
		adda.l     d1,a2
		bra.s      Adr_drag_29
Adr_drag_28:
		move.w     d5,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    38(a7),a0
		movea.l    20(a0),a2
		adda.l     d0,a2
Adr_drag_29:
		move.w     8(a2),d0
		and.w      #$0800,d0
		bne.s      Adr_drag_27
		move.w     10(a2),d1
		and.w      #$FFFE,d1
		movea.l    38(a7),a0
		movea.l    38(a7),a1
		movea.l    102(a1),a1
		move.w     d5,d0
		jsr        (a1)
Adr_drag_27:
		moveq.l    #-1,d5
		tst.w      d6
		bmi        Adr_drag_26
		move.w     d6,d0
		and.w      #$1000,d0
		beq.s      Adr_drag_30
		move.w     d6,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    24(a3),a2
		adda.l     d1,a2
		bra.s      Adr_drag_31
Adr_drag_30:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    20(a3),a2
		adda.l     d0,a2
Adr_drag_31:
		move.w     8(a2),d0
		and.w      #$2000,d0
		beq.s      Adr_drag_32
		moveq.l    #1,d1
		and.w      10(a2),d1
		bne.s      Adr_drag_33
Adr_drag_32:
		move.w     8(a2),d0
		and.w      #$0800,d0
		bne.s      Adr_drag_34
		move.w     d6,46(a7)
		move.w     #$0001,48(a7)
		lea.l      46(a7),a1
		movea.l    a3,a0
		movea.l    4(a3),a4
		moveq.l    #9,d0
		jsr        (a4)
		cmpi.w     #$0001,48(a7)
		bne.s      Adr_drag_33
		moveq.l    #1,d1
		or.w       10(a2),d1
		move.w     d6,d0
		movea.l    a3,a0
		movea.l    102(a3),a1
		jsr        (a1)
		bra.s      Adr_drag_34
Adr_drag_33:
		moveq.l    #-1,d6
Adr_drag_34:
		move.l     a3,38(a7)
		move.w     d6,d5
Adr_drag_26:
		move.w     50(a7),d0
		bne        Adr_drag_35
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      56(a0),a0
		jsr        Amo_new
		movea.l    ACSblk,a0
		move.w     #$0001,586(a0)
		tst.w      d5
		bmi        Adr_drag_36
		move.w     d5,d0
		and.w      #$1000,d0
		beq.s      Adr_drag_37
		movea.l    38(a7),a0
		move.l     24(a0),34(a7)
		bra.s      Adr_drag_38
Adr_drag_37:
		movea.l    38(a7),a0
		move.l     20(a0),34(a7)
Adr_drag_38:
		move.w     d5,d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a2
		lea.l      24(a2,d0.l),a2
		move.w     8(a2),d2
		and.w      #$8000,d2
		beq        Adr_drag_39
		move.l     4(a2),d7
		beq        Adr_drag_39
		movea.l    ACSblk,a0
		move.w     354(a7),588(a0)
		movea.l    ACSblk,a0
		move.w     352(a7),590(a0)
		movea.l    ACSblk,a0
		move.w     62(a7),592(a0)
		movea.l    ACSblk,a0
		move.w     60(a7),594(a0)
		lea.l      68(a7),a0
		jsr        Act_save
		movea.l    ACSblk,a0
		move.w     66(a7),610(a0)
		movea.l    ACSblk,a0
		move.w     (a5),612(a0)
		movea.l    ACSblk,a0
		move.w     58(a7),614(a0)
		movea.l    ACSblk,a0
		move.l     38(a7),600(a0)
		movea.l    ACSblk,a0
		move.l     34(a7),604(a0)
		move.w     d5,d0
		and.w      #$0FFF,d0
		movea.l    ACSblk,a0
		move.w     d0,608(a0)
		jsr        Amo_busy
		movea.l    4(a2),a0
		jsr        (a0)
		jsr        Amo_unbusy
		lea.l      68(a7),a0
		jsr        Act_restore
		bra        Adr_drag_40
Adr_drag_39:
		move.w     d5,d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		move.l     12(a0,d0.l),42(a7)
		movea.l    42(a7),a1
		move.l     8(a1),d2
		beq        Adr_drag_41
		bsr        Adr_start
		bsr        Adr_next
		move.w     d0,d6
		ble        Adr_drag_41
		and.w      #$1000,d0
		beq.s      Adr_drag_42
		move.w     d6,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		movea.l    24(a1),a2
		lea.l      24(a2,d1.l),a2
		bra.s      Adr_drag_43
Adr_drag_42:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		movea.l    20(a1),a2
		lea.l      24(a2,d0.l),a2
Adr_drag_43:
		move.w     22(a2),d0
		sub.w      #$000B,d0
		beq.s      Adr_drag_44
		sub.w      #$0009,d0
		beq.s      Adr_drag_44
		sub.w      #$000B,d0
		beq.s      Adr_drag_44
		bra.s      Adr_drag_41
Adr_drag_44:
		move.l     12(a2),d0
		beq.s      Adr_drag_41
		movea.l    d0,a1
		move.w     d5,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    34(a7),a0
		adda.l     d1,a0
		movea.l    42(a7),a4
		movea.l    8(a4),a4
		move.w     #$02C1,d0
		jsr        (a4)
		tst.w      d0
		bne.s      Adr_drag_40
Adr_drag_41:
		clr.l      42(a7)
Adr_drag_40:
		movea.l    38(a7),a0
		movea.l    34(a7),a1
		cmpa.l     20(a0),a1
		beq.s      Adr_drag_45
		cmpa.l     24(a0),a1
		bne.s      Adr_drag_46
Adr_drag_45:
		move.w     d5,d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		move.w     8(a0,d0.l),d2
		and.w      #$0800,d2
		bne.s      Adr_drag_46
		move.w     10(a0,d0.l),d1
		and.w      #$FFFE,d1
		movea.l    38(a7),a1
		movea.l    102(a1),a1
		movea.l    38(a7),a0
		move.w     d5,d0
		jsr        (a1)
Adr_drag_46:
		move.l     42(a7),d0
		beq.s      Adr_drag_47
		suba.l     a1,a1
		move.w     d5,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    34(a7),a0
		adda.l     d1,a0
		movea.l    d0,a4
		movea.l    8(a4),a4
		moveq.l    #5,d0
		jsr        (a4)
Adr_drag_47:
		jsr        Aev_release
		bra        Adr_drag_48
Adr_drag_36:
		tst.w      d4
		beq        Adr_drag_48
		move.w     #$FFFF,52(a7)
		move.l     _globl,-(a7)
		clr.l      -(a7)
		clr.l      -(a7)
		suba.l     a1,a1
		lea.l      68(a7),a0
		moveq.l    #11,d0
		jsr        mt_appl_getinfo
		lea.l      12(a7),a7
		tst.w      d0
		beq.s      Adr_drag_49
		moveq.l    #16,d0
		and.w      56(a7),d0
		beq.s      Adr_drag_49
		clr.l      -(a7)
		clr.l      -(a7)
		clr.l      -(a7)
		pea.l      64(a7)
		moveq.l    #20,d1
		move.w     70(a7),d0
		jsr        wind_get
		lea.l      16(a7),a7
		tst.w      d0
		bne.s      Adr_drag_49
		move.w     #$FFFF,52(a7)
Adr_drag_49:
		move.w     52(a7),d0
		bpl        Adr_drag_50
		clr.w      d3
		move.w     d3,56(a7)
		clr.b      92(a7)
		lea.l      92(a7),a0
		move.l     a0,356(a7)
		clr.l      360(a7)
		pea.l      addDD2Popup(pc)
		clr.l      -(a7)
		lea.l      364(a7),a1
		movea.l    ListOfApps,a4
		movea.l    64(a4),a4
		movea.l    ListOfApps,a0
		jsr        (a4)
		addq.w     #8,a7
		move.w     362(a7),56(a7)
		lea.l      92(a7),a0
		jsr        Ast_isEmpty
		tst.w      d0
		bne.s      Adr_drag_50
		lea.l      92(a7),a0
		jsr        strlen
		clr.b      91(a7,d0.w)
		lea.l      92(a7),a4
		move.l     a4,-(a7)
		moveq.l    #-1,d2
		moveq.l    #-1,d1
		moveq.l    #3,d0
		add.w      60(a7),d0
		movea.l    ACSblk,a0
		muls.w     18(a0),d0
		movea.l    a4,a1
		movea.l    600(a0),a0
		jsr        Ame_strpopup
		addq.w     #4,a7
		movea.l    a0,a4
		move.l     a4,d0
		beq.s      Adr_drag_50
		pea.l      DDCmpName(pc)
		movea.l    a4,a1
		movea.l    ListOfApps,a0
		movea.l    32(a0),a6
		jsr        (a6)
		addq.w     #4,a7
		move.l     a0,348(a7)
		move.w     (a0),52(a7)
Adr_drag_50:
		move.w     52(a7),d0
		bmi        Adr_drag_51
		lea.l      486(a7),a4
		lea.l      xd3774,a0
		movea.l    a4,a1
		moveq.l    #15,d0
Adr_drag_52:
		move.b     (a0)+,(a1)+
		dbf        d0,Adr_drag_52
		clr.l      480(a7)
		lea.l      xd3784,a0
		lea.l      458(a7),a1
		moveq.l    #19,d0
Adr_drag_53:
		move.b     (a0)+,(a1)+
		dbf        d0,Adr_drag_53
		clr.l      412(a7)
		clr.l      408(a7)
		jsr        Dgetdrv
		jsr        Dsetdrv
		and.l      #$00100000,d0
		beq        Adr_drag_54
		lea.l      356(a7),a1
		lea.l      xd379a,a0
		clr.w      d0
		jsr        Fxattr
		tst.l      d0
		bne        Adr_drag_54
Adr_drag_57:
		addq.b     #1,476(a7)
		cmpi.b     #$5A,476(a7)
		ble.s      Adr_drag_55
		addq.b     #1,475(a7)
		cmpi.b     #$5A,475(a7)
		bgt.s      Adr_drag_56
		move.b     #$41,476(a7)
Adr_drag_55:
		moveq.l    #2,d0
		lea.l      458(a7),a0
		jsr        Fcreate
		move.l     d0,d4
		tst.l      d0
		bmi.s      Adr_drag_57
Adr_drag_56:
		tst.l      d4
		bmi        Adr_drag_48
		clr.w      d0
		jsr        Awi_update
		move.w     #$003F,(a4)
		movea.l    ACSblk,a0
		move.w     (a0),2(a4)
		move.w     54(a7),6(a4)
		move.w     66(a7),8(a4)
		move.w     (a5),10(a4)
		move.w     58(a7),12(a4)
		move.b     475(a7),d0
		ext.w      d0
		lsl.w      #8,d0
		move.b     476(a7),d1
		ext.w      d1
		or.w       d1,d0
		move.w     d0,14(a4)
		movea.l    _globl,a1
		movea.l    a4,a0
		move.w     52(a7),d0
		moveq.l    #16,d1
		jsr        mt_appl_write
		tst.w      d0
		beq        Adr_drag_58
		moveq.l    #1,d0
		lsl.l      d4,d0
		move.l     d0,416(a7)
		clr.l      -(a7)
		suba.l     a1,a1
		lea.l      420(a7),a0
		move.w     #$0BB8,d0
		jsr        Fselect
		addq.w     #4,a7
		tst.w      d0
		beq        Adr_drag_58
		move.l     416(a7),d0
		beq        Adr_drag_58
		lea.l      478(a7),a0
		moveq.l    #1,d1
		move.w     d4,d0
		jsr        Fread
		moveq.l    #1,d1
		cmp.l      d0,d1
		bne        Adr_drag_58
		move.b     478(a7),d0
		bne        Adr_drag_58
		lea.l      424(a7),a0
		move.w     d4,d0
		moveq.l    #32,d1
		jsr        Fread
		moveq.l    #32,d1
		cmp.l      d0,d1
		bne        Adr_drag_58
		movea.l    #$00000001,a0
		moveq.l    #13,d0
		jsr        Psignal
		move.l     d0,d5
		bsr        Adr_start
		bsr        Adr_next
		move.w     d0,d6
		ble        Adr_drag_59
		and.w      #$1000,d0
		beq.s      Adr_drag_60
		move.w     d6,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		movea.l    24(a1),a2
		lea.l      24(a2,d1.l),a2
		bra.s      Adr_drag_61
Adr_drag_60:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		movea.l    20(a1),a2
		lea.l      24(a2,d0.l),a2
Adr_drag_61:
		move.w     22(a2),d0
		sub.w      #$000B,d0
		beq.s      Adr_drag_62
		sub.w      #$0009,d0
		beq.s      Adr_drag_63
		sub.w      #$000B,d0
		beq.s      Adr_drag_62
		bra        Adr_drag_64
Adr_drag_62:
		lea.l      xd37a2,a1
		lea.l      424(a7),a0
		jsr        strcpy
		bra.s      Adr_drag_65
Adr_drag_63:
		lea.l      xd37ad,a1
		lea.l      424(a7),a0
		jsr        strcpy
Adr_drag_65:
		move.w     #$000A,484(a7)
		movea.l    12(a2),a0
		jsr        strlen
		move.l     d0,420(a7)
		moveq.l    #24,d1
		asr.l      d1,d0
		and.b      #$FF,d0
		move.b     d0,428(a7)
		move.l     420(a7),d2
		moveq.l    #16,d7
		asr.l      d7,d2
		and.b      #$FF,d2
		move.b     d2,429(a7)
		move.l     420(a7),d0
		asr.l      #8,d0
		and.b      #$FF,d0
		move.b     d0,430(a7)
		moveq.l    #-1,d1
		and.b      423(a7),d1
		move.b     d1,431(a7)
		lea.l      484(a7),a0
		move.w     d4,d0
		moveq.l    #2,d1
		jsr        Fwrite
		moveq.l    #2,d1
		cmp.l      d0,d1
		bne.w      Adr_drag_59
		lea.l      424(a7),a0
		move.w     d4,d0
		moveq.l    #10,d1
		jsr        Fwrite
		moveq.l    #10,d1
		cmp.l      d0,d1
		bne.s      Adr_drag_59
		movea.l    _globl,a0
		moveq.l    #10,d0
		jsr        mt_evnt_timer
		tst.w      d0
		beq.s      Adr_drag_59
		lea.l      478(a7),a0
		moveq.l    #1,d1
		move.w     d4,d0
		jsr        Fread
		moveq.l    #1,d1
		cmp.l      d0,d1
		bne.s      Adr_drag_59
		move.b     478(a7),d0
		bne.s      Adr_drag_59
		movea.l    12(a2),a0
		move.l     a0,-(a7)
		jsr        strlen
		move.l     d0,d1
		move.w     d4,d0
		movea.l    (a7)+,a0
		jsr        Fwrite
		move.l     420(a7),d1
		cmp.l      d0,d1
		beq.s      Adr_drag_59
Adr_drag_64:
		movea.l    d5,a0
		moveq.l    #13,d0
		jsr        Psignal
		move.w     d4,d0
		jsr        Fclose
		moveq.l    #1,d0
		jsr        Awi_update
		bra.s      Adr_drag_54
Adr_drag_59:
		movea.l    d5,a0
		moveq.l    #13,d0
		jsr        Psignal
Adr_drag_58:
		moveq.l    #1,d0
		jsr        Awi_update
		move.w     d4,d0
		jsr        Fclose
		bra        Adr_drag_48
Adr_drag_54:
		bsr        Adr_start
		bsr        Adr_next
		move.w     d0,d6
		ble        Adr_drag_48
		and.w      #$1000,d0
		beq.s      Adr_drag_66
		move.w     d6,d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		movea.l    24(a1),a2
		lea.l      24(a2,d1.l),a2
		bra.s      Adr_drag_67
Adr_drag_66:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a1
		movea.l    20(a1),a2
		lea.l      24(a2,d0.l),a2
Adr_drag_67:
		move.w     22(a2),d0
		sub.w      #$000A,d0
		beq        Adr_drag_68
		subq.w     #1,d0
		beq.s      Adr_drag_69
		sub.w      #$0009,d0
		beq.s      Adr_drag_69
		sub.w      #$000B,d0
		beq.s      Adr_drag_69
		bra        Adr_drag_70
Adr_drag_69:
		movea.l    12(a2),a0
		jsr        strlen
		addq.l     #1,d0
		jsr        Ax_glmalloc
		move.l     a0,480(a7)
		move.l     a0,d0
		beq        Adr_drag_70
		movea.l    12(a2),a1
		jsr        strcpy
		moveq.l    #16,d1
		clr.w      d0
		movea.l    a4,a0
		jsr        memset
		move.w     #$0501,(a4)
		move.l     480(a7),d0
		moveq.l    #16,d1
		asr.l      d1,d0
		move.w     d0,8(a4)
		move.w     482(a7),10(a4)
		clr.w      d0
		jsr        Awi_update
		jsr        Aev_mess
		movea.l    _globl,a1
		movea.l    a4,a0
		moveq.l    #16,d1
		move.w     52(a7),d0
		jsr        mt_appl_write
		moveq.l    #16,d1
		clr.w      d0
		movea.l    a4,a0
		jsr        memset
		move.l     _globl,-(a7)
		pea.l      488(a7)
		pea.l      492(a7)
		pea.l      496(a7)
		pea.l      500(a7)
		pea.l      504(a7)
		pea.l      ($000007D0).w
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		lea.l      534(a7),a1
		movea.l    a4,a0
		clr.w      d2
		clr.w      d1
		moveq.l    #48,d0
		jsr        mt_evnt_multi
		lea.l      50(a7),a7
		move.w     d0,d5
		moveq.l    #16,d1
		and.w      d0,d1
		beq.s      Adr_drag_71
		cmpi.w     #$0500,(a4)
		beq.s      Adr_drag_72
		movea.l    _globl,a1
		movea.l    a4,a0
		movea.l    ACSblk,a6
		move.w     (a6),d0
		moveq.l    #16,d1
		jsr        mt_appl_write
		bra.s      Adr_drag_71
Adr_drag_72:
		move.w     6(a4),d0
		beq.s      Adr_drag_71
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		move.w     d6,d0
		bsr        Adr_del
Adr_drag_71:
		moveq.l    #1,d0
		jsr        Awi_update
		movea.l    480(a7),a0
		jsr        Ax_glfree
		bra        Adr_drag_70
Adr_drag_68:
		pea.l      420(a7)
		lea.l      416(a7),a1
		movea.l    12(a2),a0
		jsr        Abp_mfdb2img
		addq.w     #4,a7
		tst.w      d0
		bne        Adr_drag_70
		movea.l    412(a7),a0
		move.w     2(a0),d0
		add.w      d0,d0
		ext.l      d0
		add.l      d0,420(a7)
		move.l     420(a7),d0
		jsr        Ax_glmalloc
		move.l     a0,408(a7)
		beq        Adr_drag_73
		move.l     420(a7),d0
		movea.l    412(a7),a1
		jsr        memcpy
		moveq.l    #16,d1
		clr.w      d0
		movea.l    a4,a0
		jsr        memset
		move.w     #$0504,(a4)
		move.w     #$0001,6(a4)
		move.l     408(a7),d0
		moveq.l    #16,d1
		asr.l      d1,d0
		move.w     d0,8(a4)
		move.w     410(a7),10(a4)
		move.l     420(a7),d2
		asr.l      d1,d2
		move.w     d2,12(a4)
		move.w     422(a7),14(a4)
		clr.w      d0
		jsr        Awi_update
		jsr        Aev_mess
		movea.l    _globl,a1
		movea.l    a4,a0
		moveq.l    #16,d1
		move.w     52(a7),d0
		jsr        mt_appl_write
		moveq.l    #16,d1
		clr.w      d0
		movea.l    a4,a0
		jsr        memset
		move.l     _globl,-(a7)
		pea.l      488(a7)
		pea.l      492(a7)
		pea.l      496(a7)
		pea.l      500(a7)
		pea.l      504(a7)
		pea.l      ($00000BB8).w
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		lea.l      534(a7),a1
		movea.l    a4,a0
		clr.w      d2
		clr.w      d1
		moveq.l    #48,d0
		jsr        mt_evnt_multi
		lea.l      50(a7),a7
		move.w     d0,d5
		moveq.l    #16,d1
		and.w      d0,d1
		beq.s      Adr_drag_74
		cmpi.w     #$0500,(a4)
		beq.s      Adr_drag_75
		movea.l    _globl,a1
		movea.l    a4,a0
		movea.l    ACSblk,a2
		move.w     (a2),d0
		moveq.l    #16,d1
		jsr        mt_appl_write
		bra.s      Adr_drag_74
Adr_drag_75:
		move.w     6(a4),d0
		beq.s      Adr_drag_74
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		move.w     d6,d0
		bsr        Adr_del
Adr_drag_74:
		moveq.l    #1,d0
		jsr        Awi_update
		movea.l    408(a7),a0
		jsr        Ax_glfree
Adr_drag_73:
		movea.l    412(a7),a0
		jsr        Ax_free
Adr_drag_70:
		movea.l    ACSblk,a0
		clr.w      586(a0)
		bra.s      Adr_drag_48
Adr_drag_51:
		movea.l    ACSblk,a0
		movea.l    576(a0),a3
		lea.l      54(a7),a1
		moveq.l    #19,d0
		movea.l    4(a3),a2
		movea.l    a3,a0
		jsr        (a2)
Adr_drag_48:
		movea.l    ACSblk,a0
		move.w     586(a0),d0
		beq        Adr_drag_2
		move.w     582(a0),d1
		beq        Adr_drag_2
		moveq.l    #2,d2
		movea.l    572(a0),a1
		and.w      14(a1),d2
		beq        Adr_drag_2
		move.w     62(a7),d4
		ble.s      Adr_drag_76
		move.w     d4,d0
		bra.s      Adr_drag_77
Adr_drag_76:
		move.w     62(a7),d0
		neg.w      d0
Adr_drag_77:
		move.w     d0,-(a7)
		move.w     62(a7),d0
		ble.s      Adr_drag_78
		bra.s      Adr_drag_79
Adr_drag_78:
		move.w     62(a7),d0
		neg.w      d0
Adr_drag_79:
		add.w      (a7)+,d0
		asr.w      #5,d0
		clr.w      d5
		bra.s      Adr_drag_80
Adr_drag_81:
		move.w     d0,d1
		asr.w      #1,d1
		add.w      d0,d1
		asr.w      #2,d1
		move.w     d1,d0
		addq.w     #1,d5
Adr_drag_80:
		tst.w      d0
		bne.s      Adr_drag_81
		tst.w      d5
		beq.s      Adr_drag_82
		movea.l    ACSblk,a0
		cmpi.w     #$0008,582(a0)
		ble.s      Adr_drag_82
		subq.w     #1,d5
Adr_drag_82:
		tst.w      d5
		beq.s      Adr_drag_83
		movea.l    ACSblk,a0
		cmpi.w     #$0014,582(a0)
		ble.s      Adr_drag_83
		subq.w     #1,d5
Adr_drag_83:
		clr.w      56(a7)
		bra.s      Adr_drag_84
Adr_drag_87:
		clr.w      d0
		move.w     d0,(a5)
		move.w     d0,66(a7)
		moveq.l    #1,d3
		lsl.w      d5,d3
		bra.s      Adr_drag_85
Adr_drag_86:
		move.w     62(a7),d0
		add.w      d0,66(a7)
		move.w     60(a7),d1
		add.w      d1,(a5)
		move.w     (a5),d2
		asr.w      d5,d2
		sub.w      d2,d1
		move.w     66(a7),d4
		asr.w      d5,d4
		sub.w      d4,d0
		bsr        drag_draw
		subq.w     #1,d3
Adr_drag_85:
		tst.w      d3
		bgt.s      Adr_drag_86
Adr_drag_84:
		move.w     56(a7),d0
		addq.w     #1,56(a7)
		subq.w     #2,d0
		blt.s      Adr_drag_87
Adr_drag_2:
		lea.l      502(a7),a7
		movem.l    (a7)+,d3-d7/a2-a6
		rts

		.data

		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
xd3674:
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
xd3774:
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
		dc.b $00
xd3784:
		dc.b 'U:\PIPE\DRAGDROP.AA',0
xd3798:
		dc.w $7c00
xd379a:
		dc.b 'U:\PIPE',0
xd37a2:
		dc.b '.TXT    ',0
		dc.b $00
		dc.b $00
xd37ad:
		dc.b 'ARGS    ',0
		dc.b $00
		dc.b $00

	.bss

pattern: ds.w 1
drags: ds.b 8192
